!function(a){!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.imjs=a()}}(function(){var b;return function c(a,b,d){function e(g,h){if(!b[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=b[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,c,a,b,d)}return b[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){(function(){c.ACCEPT_HEADER={xml:"application/xml",json:"application/json",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",csv:"text/comma-separated-values",fasta:"text/x-fasta",gff3:"text/x-gff3",bed:"text/x-bed",objects:"application/json;type=objects",jsonobjects:"application/json;type=objects",jsontable:"application/json;type=table",jsonrows:"application/json;type=rows",jsoncount:"application/json;type=count",jsonp:"application/javascript",jsonpobjects:"application/javascript;type=objects",jsonptable:"application/javascript;type=table",jsonprows:"application/javascript;type=rows",jsonpcount:"application/javascript;type=count"}}).call(this)},{}],2:[function(c,d,e){(function(e){(function(){var f,g,h;c("./shiv"),d.exports=g=c("./service"),h=g.utils.merge,f=function(a,c){return"function"==typeof b&&b.amd?b(a,[],c):e[a]=c},f("imjs",g),"undefined"==typeof a?f("intermine",g):f("intermine",h(a,g))}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./service":10,"./shiv":12}],3:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;f=a("url"),d=a("JSONStream"),n=a("http"),b=a("./constants").ACCEPT_HEADER,i=a("./version").VERSION,u=t=a("./util"),l=u.error,k=u.defer,p=u.merge,o=u.invoke,h="node-http/imjs-"+i,e=/,\s*$/,g="application/x-www-form-urlencoded",c.supports=function(){return!0},s=function(a,b,c){return function(a){var e,f;return null==a.pipe?c(new Error("response is not a stream")):(a.on("error",c),null!=a.statusCode&&200!==a.statusCode?(e=d.parse("error"),e.pause(),a.pipe(e),c([a.statusCode,e])):(f=d.parse("results.*"),f.pause(),a.pipe(f),b(f)))}},m=function(a,b,c,d){var e,f;return e=a.type,f=a.url,"Could not parse response to "+e+" "+f+': "'+b+'" ('+d+": "+c+")"},j=function(a,b,c){return function(d){var e;return e="",d.on("data",function(a){return e+=a}),d.on("error",c),d.on("end",function(){var f,g,h,i,j,k,l;if(null!=(null!=d?d.headers:void 0)&&(f=d.headers["content-type"]),"application/json"!==f&&!/json/.test(a.dataType)&&!/json/.test(a.data.format))return(j=e.match(/\[ERROR\] (\d+)([\s\S]*)/))?c(new Error(j[2])):(i=200<=(l=d.statusCode)&&400>l?b:c)(e);if(""===e&&200===d.statusCode)return b();try{return k=JSON.parse(e),(h=k.error)?c(new Error(h)):b(k)}catch(n){return g=n,c(d.statusCode>=400?new Error(d.statusCode):new Error(m(a,e,g,d.statusCode)))}})}},c.iterReq=function(a,b,c){return function(d,e,f,g,h){var i,j,k,m,n;return null==e&&(e={}),null==f&&(f=function(){}),null==g&&(g=function(){}),null==h&&(h=function(){}),t.isFunction(e)&&(n=[{},e,f,g],e=n[0],f=n[1],g=n[2],h=n[3]),m=p({format:c},e,{query:d.toXML()}),i=function(a){return a.on("data",f),a.on("error",g),a.on("end",h),setTimeout(function(){return null!=a.resume?a.resume():void 0},3),a},k=function(a){var b,c;return c=a[0],b=a[1],b.on("data",g),b.on("error",g),b.on("end",h),null!=b.resume&&b.resume(),l(c)},j=this.makeRequest(a,b,m,null,!0),j.then(i,k),j}},r=function(a,b,c){var d;return d=setTimeout(function(){return b("Request timed out.")},a),c.then(function(){return cancelTimeout(d)})},q=function(a){var c,d,e,i,j,k,l,m;if(!a.url)throw new Error("No url provided in "+JSON.stringify(a));if("string"==typeof a.data){if(e=a.data,"GET"===(k=a.type)||"DELETE"===k)throw new Error("Invalid request. "+a.type+" requests must not have bodies")}else e=t.querystring(a.data);if(d=f.parse(a.url,!0),d.withCredentials=!1,d.method=a.type||"GET",null!=a.port&&(d.port=a.port),d.headers={"User-Agent":h,Accept:b[a.dataType]},("GET"===(l=d.method)||"DELETE"===l)&&(null!=e?e.length:void 0)?(i=/\?/.test(d.path)?"&":"?",d.path+=i+e,e=null):(d.headers["Content-Type"]=(a.contentType||g)+"; charset=UTF-8",d.headers["Content-Length"]=e.length),null!=a.headers){m=a.headers;for(c in m)j=m[c],d.headers[c]=j}return null!=a.auth&&(d.auth=a.auth),[d,e]},c.doReq=function(a,b){var c,d,e,f,g,h,i,l,m,o,p;o=k(),f=o.promise,i=o.resolve,g=o.reject,f.then(null,a.error);try{p=q(a),m=p[0],e=p[1],d=(b?s:j)(a,i,g),h=n.request(m,d),h.on("error",function(b){return g(new Error("Error: "+m.method+" "+a.url+": "+b))}),null!=e&&h.write(e),h.end(),l=a.timeout,l>0&&r(l,g,f)}catch(t){c=t,g(c)}return f}}).call(this)},{"./constants":1,"./util":15,"./version":16,JSONStream:18,http:52,url:49}],4:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q={}.hasOwnProperty,r=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},s=function(a,b){return function(){return a.apply(b,arguments)}};k=a("./util"),n=c,o=k.uniqBy,i=k.difference,h=k.defer,p=k.withCB,m=k.id,l=k.get,j=k.fold,g=k.concatMap,f=6e4,b=function(){function a(a){var b,c;for(b in a)q.call(a,b)&&(c=a[b],this[b]=c)}var b;return a.prototype.getStats=function(a){return null!=a?this.stats[a]:this.stats},b=g(l("matches")),a.prototype.getMatches=function(a){var c;return"MATCH"===a?this.matches[a]:null!=(c=b(this.matches[a]))?c:[]},a.prototype.getMatchIds=function(a){return null!=a?this.getMatches(a).map(l("id")):this.allMatchIds()},a.prototype.goodMatchIds=function(){return this.getMatchIds("MATCH")},a.prototype.allMatchIds=function(){var a;return(a=j(function(a){return function(b,c){return b.concat(a.getMatchIds(c))}}(this)))(this.goodMatchIds(),["DUPLICATE","WILDCARD","TYPE_CONVERTED","OTHER"])},a}(),e=function(){function a(a){var b,c;for(b in a)q.call(a,b)&&(c=a[b],this[b]=c)}var b,c,d,e;return e=o(m),b=g(m),c=function(a){var c,d;return b(function(){var b,e;b=a.identifiers,e=[];for(c in b)d=b[c],e.push(d);return e}())},d=function(a,b){return null==b||r.call(c(a),b)>=0},a.prototype.getStats=function(a){switch(a){case"objects":return this.getObjectStats();case"identifiers":return this.getIdentifierStats();default:return{objects:this.getObjectStats(),identifiers:this.getIdentifierStats()}}},a.prototype.getIdentifierStats=function(){var a,c,d,f,g,h;return h=function(a){var c,d;return e(b(function(){var b,e,f;for(f=[],b=0,e=a.length;e>b;b++)d=a[b],f.push(function(){var a;a=[];for(c in null!=d?d.identifiers:void 0)a.push(c);return a}());return f}()))},f=h(this.getMatches("MATCH")),c=h(this.getMatches()),g=f.length,a=c.length,d=i(c,f).length,{matches:g,all:a,issues:d}},a.prototype.getObjectStats=function(){var a,b,d,e;return e=this.goodMatchIds().length,a=this.allMatchIds().length,b=function(){var a;a=[];for(m in this)q.call(this,m)&&(d=this[m],r.call(c(d),"MATCH")<0&&a.push(m));return a}.call(this).length,{matches:e,all:a,issues:b}},a.prototype.getMatches=function(a){var b,c;c=[];for(m in this)q.call(this,m)&&(b=this[m],d(b,a)&&c.push(b));return c},a.prototype.getMatchIds=function(a){var b,c;c=[];for(m in this)q.call(this,m)&&(b=this[m],d(b,a)&&c.push(m));return c},a.prototype.goodMatchIds=function(){return this.getMatchIds("MATCH")},a.prototype.allMatchIds=function(){return this.getMatchIds()},a}(),d=function(){function a(a,b){this.uid=a,this.service=b,this.del=s(this.del,this),this.fetchResults=s(this.fetchResults,this),this.fetchErrorMessage=s(this.fetchErrorMessage,this),this.fetchStatus=s(this.fetchStatus,this)}return a.prototype.fetchStatus=function(a){return p(a,this.service.get("ids/"+this.uid+"/status").then(l("status")))},a.prototype.fetchErrorMessage=function(a){return p(a,this.service.get("ids/"+this.uid+"/status").then(l("message")))},a.prototype.fetchResults=function(a){var c,d;return c=this.service.get("ids/"+this.uid+"/result").then(l("results")),d=this.service.fetchVersion(),d.then(function(a){return c.then(function(c){return a>=16?new b(c):new e(c)})})},a.prototype.del=function(a){return p(a,this.service.makeRequest("DELETE","ids/"+this.uid))},a.prototype.decay=50,a.prototype.poll=function(a,b,c){var d,e,g,i,j,k,l;return l=h(),g=l.promise,j=l.resolve,i=l.reject,g.then(a,b),e=null!=c?c:function(){},k=this.fetchStatus(),k.then(null,i),d=this.decay,this.decay=Math.min(f,1.25*d),k.then(function(a){return function(b){switch(e(b),b){case"SUCCESS":return a.fetchResults().then(j,i);case"ERROR":return a.fetchErrorMessage().then(i,i);default:return setTimeout(function(){return a.poll(j,i,e)},d)}}}(this)),g},a}(),d.prototype.wait=d.prototype.poll,d.create=function(a){return function(b){return new d(b,a)}},n.IDResolutionJob=d,n.CategoryResults=b,n.IdResults=e}).call(this)},{"./util":15}],5:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=function(a,b){return function(){return a.apply(b,arguments)}},s={}.hasOwnProperty,t=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};p=a("./util"),k=c,n=p.merge,q=p.withCB,i=p.get,l=p.invoke,e=p.REQUIRES_VERSION,o=p.set,h=p.dejoin,g="list/tags",f="lists/shares",b="lists/invitations",m=function(a){return"__folder__"===a.substr(0,a.indexOf(":"))},j=function(a){return a.substr(a.indexOf(":")+1)},d=function(){function a(a,b){var c,d;this.service=b,this._updateTags=r(this._updateTags,this),this.hasTag=r(this.hasTag,this);for(c in a)s.call(a,c)&&(d=a[c],this[c]=d);this.dateCreated=null!=this.dateCreated?new Date(this.dateCreated):null,this.folders=this.tags.filter(m).map(j)}var c;return a.prototype.hasTag=function(a){return t.call(this.tags,a)>=0},a.prototype.query=function(a){return null==a&&(a=["*"]),this.service.query({select:a,from:this.type,where:[[this.type,"IN",this.name]]})},a.prototype.del=function(a){return this.service.makeRequest("DELETE","lists",{name:this.name},a)},c=function(a){var b;return b=a.tags},a.prototype._updateTags=function(a,b){return null==a?(this.tags=b.slice(),this.folders=this.tags.filter(m).map(j)):void 0},a.prototype.fetchTags=function(a){return q(this._updateTags,a,this.service.makeRequest("GET","list/tags",{name:this.name}).then(c))},a.prototype.addTags=function(a,b){var d;return d={name:this.name,tags:a},q(this._updateTags,b,this.service.makeRequest("POST","list/tags",d).then(c))},a.prototype.removeTags=function(a,b){var d;return d={name:this.name,tags:a},q(this._updateTags,b,this.service.makeRequest("DELETE","list/tags",d).then(c))},a.prototype.contents=function(a){return q(a,this.query().then(h).then(l("records")))},a.prototype.rename=function(a,b){var c;return c=this.service.post("lists/rename",{oldname:this.name,newname:a}).then(i("listName")).then(function(a){return function(b){return a.name=b}}(this)).then(this.service.fetchList),q(b,c)},a.prototype.copy=function(a,b){var c,d,e,f,g,h,j;return null==a&&(a={}),null==b&&(b=function(){}),1===arguments.length&&p.isFunction(a)&&(g=[{},a],a=g[0],b=g[1]),"string"==typeof a&&(a={name:a}),d=c=null!=(h=a.name)?h:""+this.name+"_copy",f=this.tags.concat(null!=(j=a.tags)?j:[]),e=this.query(["id"]),q(b,this.service.fetchLists().then(l("map",i("name"))).then(function(a){return function(b){var g;for(g=1;t.call(b,d)>=0;)d=""+c+"-"+g++;return e.then(l("saveAsList",{name:d,tags:f,description:a.description}))}}(this)))},a.prototype.enrichment=function(a,b){return this.service.enrichment(n({list:this.name},a),b)},a.prototype.shareWithUser=function(a,b){return q(b,this.service.post(f,{list:this.name,"with":a}))},a.prototype.inviteUserToShare=function(a,c,d){return null==c&&(c=!0),null==d&&(d=function(){}),q(d,this.service.post(b,{list:this.name,to:a,notify:!!c}))},a}(),k.List=d}).call(this)},{"./util":15}],6:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m=function(a,b){return function(){return a.apply(b,arguments)}},n=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};f=a("./table").Table,e=a("./path").PathInfo,l=a("./util"),i=l.flatten,h=l.find,g=l.error,k=l.omap,j=c,b=new f({name:"Object",tags:[],displayName:"Object",attributes:{},references:{},collections:{}}),d=function(){function a(a){var c,d;this.name=a.name,c=a.classes,this.findCommonType=m(this.findCommonType,this),this.findSharedAncestor=m(this.findSharedAncestor,this),this.getAncestorsOf=m(this.getAncestorsOf,this),this.getSubclassesOf=m(this.getSubclassesOf,this),this.getPathInfo=m(this.getPathInfo,this),d=k(function(a){return function(b,c){return[b,new f(c,a)]}}(this)),this.classes=d(c),this.classes["java.lang.Object"]=b}return a.prototype.getPathInfo=function(a,b){return e.parse(this,a,b)},a.prototype.getSubclassesOf=function(a){var b,c,d,e,f,g;if(c=a&&a.name?a:this.classes[a],null==c)throw new Error(""+a+" is not a table");d=[c.name],f=this.classes;for(e in f)b=f[e],g=c.name,n.call(b.parents(),g)>=0&&(d=d.concat(this.getSubclassesOf(b)));return d},a.prototype.getAncestorsOf=function(a){var b,c;if(b=a&&a.name?a:this.classes[a],null==b)throw new Error(""+a+" is not a table");return c=b.parents(),c.filter(function(a){return function(b){return a.classes[b]}}(this)).reduce(function(a){return function(b,c){return b.concat(a.getAncestorsOf(c))}}(this),c)},a.prototype.findSharedAncestor=function(a,b){var c,d,e;return null===b||null===a?null:a===b?a:(c=this.getAncestorsOf(a),n.call(c,b)>=0?b:(d=this.getAncestorsOf(b),n.call(d,a)>=0?a:e=h(c,function(a){return n.call(d,a)>=0})))},a.prototype.findCommonType=function(a){return null==a&&(a=[]),a.reduce(this.findSharedAncestor)},a}(),d.prototype.makePath=d.prototype.getPathInfo,d.prototype.findCommonTypeOfMultipleClasses=d.prototype.findCommonType,d.load=function(a){var b;try{return new d(a)}catch(c){throw b=c,new Error("Error loading model: "+b)}},d.INTEGRAL_TYPES=["int","Integer","long","Long"],d.FRACTIONAL_TYPES=["double","Double","float","Float"],d.NUMERIC_TYPES=d.INTEGRAL_TYPES.concat(d.FRACTIONAL_TYPES),d.BOOLEAN_TYPES=["boolean","Boolean"],j.Model=d}).call(this)},{"./path":7,"./table":13,"./util":15}],7:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q=function(a,b){return function(){return a.apply(b,arguments)}},r=[].slice,s=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};k=c,o=a("./util"),p=o.withCB,g=o.concatMap,j=o.get,f=o.any,m=o.set,h=o.copy,n=o.success,i=o.error,b={},d={},l=function(a,b,c){var d,e,f;return""+(null!=a?a.name:void 0)+"|"+(null!=a&&null!=(f=a.service)?f.root:void 0)+"|"+b+":"+function(){var a;a=[];for(d in c)e=c[d],a.push(""+d+"="+e);return a}()},e=function(){function a(a){var b,c;this.root=a.root,this.model=a.model,this.descriptors=a.descriptors,this.subclasses=a.subclasses,this.displayName=a.displayName,this.ident=a.ident,this.allDescriptors=q(this.allDescriptors,this),this.getChildNodes=q(this.getChildNodes,this),this.getDisplayName=q(this.getDisplayName,this),this.isa=q(this.isa,this),this.append=q(this.append,this),this.getParent=q(this.getParent,this),this.getEndClass=q(this.getEndClass,this),this.containsCollection=q(this.containsCollection,this),this.isCollection=q(this.isCollection,this),this.isReverseReference=q(this.isReverseReference,this),this.isReference=q(this.isReference,this),this.isClass=q(this.isClass,this),this.isAttribute=q(this.isAttribute,this),this.isRoot=q(this.isRoot,this),c=this.descriptors,this.mid=2<=c.length?r.call(c,0,b=c.length-1):(b=0,[]),this.end=c[b++],null==this.ident&&(this.ident=l(this.model,this,this.subclasses))}return a.prototype.isRoot=function(){return 0===this.descriptors.length},a.prototype.isAttribute=function(){return null!=this.end&&!this.isReference()},a.prototype.isClass=function(){return this.isRoot()||this.isReference()},a.prototype.isReference=function(){var a;return null!=(null!=(a=this.end)?a.referencedType:void 0)},a.prototype.isReverseReference=function(){var a,b,c,d,e;return this.isReference()&&this.mid.length>0?(e=this.end,d=e.reverseReference,c=e.referencedType,b=this.getParent(),a=b.getParent(),null!=c&&a.isa(c)&&b.end.name===d):!1},a.prototype.isCollection=function(){var a,b;return null!=(a=null!=(b=this.end)?b.isCollection:void 0)?a:!1},a.prototype.containsCollection=function(){return f(this.descriptors,function(a){return a.isCollection})},a.prototype.getEndClass=function(){var a;return this.model.classes[this.subclasses[this.toString()]||(null!=(a=this.end)?a.referencedType:void 0)]||this.root},a.prototype.getParent=function(){var b;if(this.isRoot())throw new Error("Root paths do not have parents");return b={root:this.root,model:this.model,descriptors:this.mid.slice(),subclasses:this.subclasses},new a(b)},a.prototype.append=function(b){var c,d;if(this.isAttribute())throw new Error(""+this+" is an attribute.");if(d="string"==typeof b?this.getType().fields[b]:b,null==d)throw new Error(""+b+" is not a field of "+this.getType());return c={root:this.root,model:this.model,descriptors:this.descriptors.concat([d]),subclasses:this.subclasses},new a(c)},a.prototype.isa=function(a){var b,c;return null==a?!1:this.isAttribute()?this.getType()===a:(b=a.name?a.name:""+a,c=this.getType(),b===c.name||s.call(this.model.getAncestorsOf(c),b)>=0)},a.prototype.getDisplayName=function(a){var c,d,e,f;return(d=this.displayName)?n(d):(null==this.namePromise&&(this.namePromise=(c=b[this.ident])?n(c):this.isRoot()&&this.root.displayName?n(this.root.displayName):null==this.model.service?i("No service"):(f="model"+g(function(a){return"/"+a.name})(this.allDescriptors()),e=m({format:"json"})(h(this.subclasses)),this.model.service.get(f,e).then(j("display")).then(function(a){return function(c){var d;return null!=b[d=a.ident]?b[d]:b[d]=c}}(this)))),p(a,this.namePromise))},a.prototype.getChildNodes=function(){var a,b,c,d,e;d=(null!=(c=this.getEndClass())?c.fields:void 0)||{},e=[];for(b in d)a=d[b],e.push(this.append(a));return e},a.prototype.allDescriptors=function(){return[this.root].concat(this.descriptors)},a.prototype.toString=function(){return this.allDescriptors().map(j("name")).join(".")},a.prototype.equals=function(a){return this===a||this.ident&&(null!=a?a.ident:void 0)===this.ident},a.prototype.getType=function(){var a,b;return(null!=(a=this.end)&&null!=(b=a.type)?b.replace(/java\.lang\./,""):void 0)||this.getEndClass()},a}(),e.prototype.toPathString=e.prototype.toString,e.parse=function(a,b,c){var f,g,h,i,j,k,m,n,o;return null==c&&(c={}),j=l(a,b,c),(f=d[j])?f:(n=(b+"").split("."),o=g=a.classes[n.shift()],k=o.name,h=function(){var d,e,f,h;for(h=[],d=0,e=n.length;e>d;d++){if(m=n[d],i=(null!=g?g.fields[m]:void 0)||(null!=(f=g=a.classes[c[k]])?f.fields[m]:void 0),!i)throw new Error("Could not find "+m+" in "+g+" when parsing "+b);k+="."+m,g=a.classes[i.type||i.referencedType],h.push(i)}return h}(),d[j]=new e({root:o,model:a,descriptors:h,subclasses:c,ident:j}))},e.flushCache=function(){return d={},b={}},k.PathInfo=e}).call(this)},{"./util":15}],8:[function(a,b,c){(function(){var c;c=a("es6-promise").Promise,b.exports=c}).call(this)},{"es6-promise":23}],9:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},aa=function(a,b){return function(){return a.apply(b,arguments)}},ba=[].slice,ca={}.hasOwnProperty;e=a("backbone-events-standalone"),B=c,B.xml=a("./xml"),S=a("./util"),h=S.REQUIRES_VERSION,T=S.withCB,F=S.merge,u=S.filter,K=S.partition,v=S.fold,p=S.concatMap,z=S.id,w=S.get,E=S.invoke,P=S.querystring,x=function(a){var b;if(b=null!=(null!=a?a.toLowerCase:void 0)?g.OP_DICT[a.toLowerCase()]:null,!b)throw new Error("Illegal constraint operator: "+a);return b},b=["path","op","code"],j=b.concat(["value","extraValue"]),i=["rowByRow","eachRow","recordByRecord","eachRecord","records","rows","table","tableRows","values"],f=function(a){return S.compose(a.fetchList,w("listName"))},d=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],r=function(a){return null==a&&(a=""),a.substr(a.indexOf("."))},o=function(a){return null!=a?"<value>"+S.escape(a)+"</value>":"<nullValue/>"},l=function(a,b){var c,d;return function(){var e;e=[];for(c in a)d=a[c],_.call(b,c)>=0&&e.push(""+c+'="'+S.escape(d)+'" ');return e}().join("")},J=function(a){return"<constraint "+l(a,b)+"/>"},Q=function(a){return"<constraint "+l(a,["path","type"])+"/>"},M=function(a){return"<constraint "+l(a,j)+"/>"},H=function(a){return"<constraint "+l(a,b)+">"+p(o)(a.values)+"</constraint>"},A=function(a){return"<constraint "+l(a,b)+'ids="'+a.ids.join(",")+'"/>'},m=function(a){var b;return null!=a.values?H(a):null!=a.ids?A(a):null==a.op?Q(a):(b=a.op,_.call(g.NULL_OPS,b)>=0?J(a):M(a))},y=function(a){return a.replace(/^[^\.]+\./,"")},q=function(a){var b,c,d,e,f,g,h,i,j,k,l;return g=a.path,j=a.type,f=a.op,k=a.value,l=a.values,d=a.extraValue,e=a.ids,b=a.code,c=a.editable,i=a.switched,h=a.switchable,e=null!=e?e.slice():void 0,l=null!=l?l.slice():void 0,I({path:g,type:j,op:f,value:k,values:l,extraValue:d,ids:e,code:b,editable:c,switched:i,switchable:h})},n=function(a){var b;return b=q(a),b.path=y(b.path),b},I=function(a){var b,c;for(b in a)c=a[b],null==c&&delete a[b];return a},s=function(a,b){return"Did not remove a single constraint. original = "+a+", reduced = "+b},D=function(a,b){var c,d,e,f,h,i,j;if(c={path:a},null===b)c.op="IS NULL";else if(S.isArray(b))c.op="ONE OF",c.values=b;else if("string"==(i=typeof b)||"number"===i||"boolean"===i)j="function"==typeof b.toUpperCase?b.toUpperCase():void 0,_.call(g.NULL_OPS,j)>=0?c.op=b:(c.op="=",c.value=b);else if(e=function(){var a;a=[];for(d in b)h=b[d],a.push(d);return a}(),_.call(e,"isa")>=0)S.isArray(b.isa)?(c.op=d,c.values=b.isa):c.type=b.isa;else{_.call(e,"extraValue")>=0&&(c.extraValue=b.extraValue);for(d in b)f=b[d],"extraValue"!==d&&(c.op=d,S.isArray(f)?c.values=f:c.value=f)}return c},C=function(a){var b,c,d,e;return a=a.slice(),c={path:a.shift()},1===a.length?(b=a[0],e="function"==typeof b.toUpperCase?b.toUpperCase():void 0,_.call(g.NULL_OPS,e)>=0?c.op=b:c.type=b):a.length>=2&&(c.op=a[0],d=a[1],S.isArray(d)?c.values=d:c.value=d,3===a.length&&(c.extraValue=a[2])),c},O=function(a){var b;return function(){var c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(""+b.path+" "+b.direction);return e}().join(" ")},N=function(a){var b,c,d,e,f,g,h;if(null==a)return[];for(c=a.split(/\s+/),d=function(){var a,b,d;for(d=[],e=a=0,b=c.length/2;b>=0?b>a:a>b;e=b>=0?++a:--a)d.push(2*e);return d}(),h=[],f=0,g=d.length;g>f;f++)b=d[f],h.push([c[b],c[b+1]]);return h},L=function(){var a,b;return b=this.sortOrder,this.sortOrder=function(){var c,d,e;for(e=[],c=0,d=b.length;d>c;c++)a=b[c],this.isRelevant(a.path)&&e.push(a);return e}.call(this),b.length!==this.sortOrder.length?this.trigger("change:sortorder change:orderby",this.sortOrder.slice()):void 0},g=function(){function a(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;for(i=null!=c?c:{},d=i.model,f=i.summaryFields,this.addConstraint=aa(this.addConstraint,this),this.expandStar=aa(this.expandStar,this),this.adjustPath=aa(this.adjustPath,this),this.select=aa(this.select,this),null==a&&(a={}),this.constraints=[],this.views=[],this.joins={},this.displayNames=S.copy(null!=(j=null!=(l=a.displayNames)?l:a.aliases)?j:{}),m=["name","title","comment","description","type"],g=0,h=m.length;h>g;g++)e=m[g],null!=a[e]&&(this[e]=a[e]);this.service=null!=b?b:{},this.model=null!=(n=null!=d?d:a.model)?n:{},this.summaryFields=null!=(o=null!=f?f:a.summaryFields)?o:{},this.root=null!=(p=a.root)?p:a.from,this.maxRows=null!=(q=null!=(r=a.size)?r:a.limit)?q:a.maxRows,this.start=null!=(s=null!=(k=a.start)?k:a.offset)?s:0,this.select(a.views||a.view||a.select||[]),this.addConstraints(a.constraints||a.where||[]),this.addJoins(a.joins||a.join||[]),this.orderBy(a.sortOrder||a.orderBy||[]),null!=a.constraintLogic&&(this.constraintLogic=a.constraintLogic),this.on("change:views",L,this)}var b,c,e,g,i,j,k,o,t;return a.JOIN_STYLES=["INNER","OUTER"],a.BIO_FORMATS=["gff3","fasta","bed"],a.NULL_OPS=["IS NULL","IS NOT NULL"],a.ATTRIBUTE_VALUE_OPS=["=","!=",">",">=","<","<=","CONTAINS","LIKE","NOT LIKE"],a.MULTIVALUE_OPS=["ONE OF","NONE OF"],a.RANGE_OPS=["OVERLAPS","DOES NOT OVERLAP","OUTSIDE","WITHIN","CONTAINS","DOES NOT CONTAIN"],a.TERNARY_OPS=["LOOKUP"],a.LOOP_OPS=["=","!="],a.LIST_OPS=["IN","NOT IN"],a.OP_DICT={"=":"=","==":"==",eq:"=",eqq:"==","!=":"!=",ne:"!=",">":">",gt:">",">=":">=",ge:">=","<":"<",lt:"<","<=":"<=",le:"<=",contains:"CONTAINS",CONTAINS:"CONTAINS","does not contain":"DOES NOT CONTAIN","DOES NOT CONTAIN":"DOES NOT CONTAIN",like:"LIKE",LIKE:"LIKE","not like":"NOT LIKE","NOT LIKE":"NOT LIKE",lookup:"LOOKUP","IS NULL":"IS NULL","is null":"IS NULL","IS NOT NULL":"IS NOT NULL","is not null":"IS NOT NULL","ONE OF":"ONE OF","one of":"ONE OF","NONE OF":"NONE OF","none of":"NONE OF","in":"IN","not in":"NOT IN",IN:"IN","NOT IN":"NOT IN",WITHIN:"WITHIN",within:"WITHIN",OVERLAPS:"OVERLAPS",overlaps:"OVERLAPS","DOES NOT OVERLAP":"DOES NOT OVERLAP","does not overlap":"DOES NOT OVERLAP",OUTSIDE:"OUTSIDE",outside:"OUTSIDE",ISA:"ISA",isa:"ISA"},i=["name","view","sortOrder","constraintLogic","title","description","comment"],c=["path","type","op","code","value","ids"],k=function(a,b){var c,d,e,f;for(f=[],d=0,e=b.length;e>d;d++)c=b[d],a.hasAttribute(c)&&f.push([c,a.getAttribute(c)]);return f},e=function(a,b){var c,d,e,f,g;for(f=a.getElementsByTagName(b),g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(c);return g},t=function(a){return function(b){return b.getAttribute(a)}},a.fromXML=function(a){var b,d,f,g,h,j,l;if(d=B.xml.parse(a),j=e(d,"query")[0]||e(d,"template")[0],!j)throw new Error("no query in xml");return g=t("path"),l=t("style"),h=S.pairsToObj(k(j,i)),h.view=h.view.split(/\s+/),h.sortOrder=N(h.sortOrder),h.joins=function(){var a,b,c,d;for(c=e(j,"join"),d=[],a=0,b=c.length;b>a;a++)f=c[a],"OUTER"===l(f)&&d.push(g(f));return d}(),h.constraints=function(){var a,d,f,g;for(f=e(j,"constraint"),g=[],a=0,d=f.length;d>a;a++)b=f[a],g.push(function(a){var b,d,f,g,h;return b=S.pairsToObj(k(a,c)),null!=b.ids&&(b.ids=function(){var a,c,d,e;for(d=b.ids.split(","),e=[],a=0,c=d.length;c>a;a++)h=d[a],e.push(parseInt(h,10));return e}()),g=e(a,"value"),g.length&&(b.values=function(){var a,b,c;for(c=[],a=0,b=g.length;b>a;a++)f=g[a],c.push(function(){var a,b,c,e;for(c=f.childNodes,e=[],a=0,b=c.length;b>a;a++)d=c[a],e.push(d.data);return e}().join(""));return c}()),b}(b));return g}(),h},a.prototype.constraints=[],a.prototype.views=[],a.prototype.joins={},a.prototype.constraintLogic="",a.prototype.sortOrder="",a.prototype.name=null,a.prototype.title=null,a.prototype.comment=null,a.prototype.description=null,a.prototype.removeFromSelect=function(a){var b,c,d,e;return null==a&&(a=[]),a=S.stringList(a),b=S.compose(this.expandStar,this.adjustPath),a=S.flatten(function(){var c,e,f;for(f=[],c=0,e=a.length;e>c;c++)d=a[c],f.push(b(d));return f}()),this.sortOrder=function(){var b,d,e,f,g;for(e=this.sortOrder,g=[],b=0,d=e.length;d>b;b++)c=e[b],f=c.path,_.call(a,f)>=0||g.push(c);return g}.call(this),this.views=function(){var b,c,d,f;for(d=this.views,f=[],b=0,c=d.length;c>b;b++)e=d[b],_.call(a,e)>=0||f.push(e);return f}.call(this),this.trigger("remove:view",a),this.trigger("change:views",this.views),this.trigger("change",this.views)},a.prototype.removeConstraint=function(a,b){var c,d,e,f;if(null==b&&(b=!1),e=this.constraints,d="string"==typeof a?function(b){return b.code===a}:function(b){var c,d;return b.path===a.path&&b.op===a.op&&b.value===a.value&&b.extraValue===a.extraValue&&a.type===b.type&&(null!=(c=b.values)?c.join("%%"):void 0)===(null!=(d=a.values)?d.join("%%"):void 0)},f=function(){var a,b,f;for(f=[],a=0,b=e.length;b>a;a++)c=e[a],d(c)||f.push(c);return f}(),f.length!==e.length-1)throw new Error(s(e,f));return this.constraints=f,b?void 0:(this.trigger("change:constraints"),this.trigger("change"),this.trigger("removed:constraint",S.find(e,d)))},a.prototype.addToSelect=function(a,b){var c,d,e,f,g,h,i,j;if(null==a&&(a=[]),null==b&&(b={}),a=S.stringList(a),d=S.compose(this.expandStar,this.adjustPath),f=S.flatten(function(){var b,c,e;for(e=[],b=0,c=a.length;c>b;b++)g=a[b],e.push(d(g));return e}()),c=function(){var a,b,c;for(c=[],a=0,b=f.length;b>a;a++)e=f[a],_.call(this.views,e)>=0&&c.push(e);return c}.call(this),c.length)throw new Error(""+c+" already in the select list");if(c=function(){var a,b,c;for(c=[],a=0,b=f.length;b>a;a++)e=f[a],function(){var a,b,c;for(c=[],a=0,b=f.length;b>a;a++)h=f[a],h===e&&c.push(h);return c}().length>1&&c.push(e);return c}(),c.length)throw new Error(""+c+" specified multiple times as arguments to addToSelect");return(i=this.views).push.apply(i,f),b.silent?b.events=(null!=(j=b.events)?j:[]).concat(["change","add:view","change:views"]):(this.trigger("add:view change:views",f),this.trigger("change")),this},a.prototype.select=function(a,b){var c,d;d=this.views.slice();try{this.views=[],this.addToSelect(a,b)}catch(e){c=e,this.views=d,S.error(c)}return this},a.prototype.adjustPath=function(a){return a=a&&a.name?a.name:""+a,null!=this.root?a.match("^"+this.root)||(a=this.root+"."+a):this.root=a.split(".")[0],a},a.prototype.getPossiblePaths=function(a,b,c){var d,e,f,g,h;return null==a&&(a=3),null==b&&(b=!0),null==c&&(c=null),g="string"==typeof c?function(a){return a[c]()}:c,d=function(a){return function(c,e){var f,g,h,i,j,k;return j=a.getPathInfo(c),!b&&j.isReverseReference()?[]:j.isAttribute()?[j]:(f=j.getType(),k=p(function(a){return d(""+c+"."+a.name,e-1)}),i=f&&e>0?k(function(){var a,b;a=f.fields,b=[];for(h in a)g=a[h],b.push(g);return b}()):[],[j].concat(i))}}(this),e=""+a+"-"+b,null==this._possiblePaths&&(this._possiblePaths={}),f=(null!=(h=this._possiblePaths)[e]?h[e]:h[e]=d(this.root,a)).slice(),null!=g?f.filter(g):f},a.prototype.getPathInfo=function(a){var b,c,d;return b=this.adjustPath(a),c=null!=(d=this.model)&&"function"==typeof d.getPathInfo?d.getPathInfo(b,this.getSubclasses()):void 0,c&&b in this.displayNames&&(c.displayName=this.displayNames[b]),c},a.prototype.makePath=a.prototype.getPathInfo,o=function(a){return[a.path,a.type]},j=S.compose(S.pairsToObj,S.map(o),u(w("type"))),a.prototype.getSubclasses=function(){return j(this.constraints)},a.prototype.getType=function(a){return this.getPathInfo(a).getType()},a.prototype.getViewNodes=function(){var a,b;return b=function(a){return function(b){return a.getPathInfo(b).getParent()}}(this),S.uniqBy(String,function(){var c,d,e,f;for(e=this.views,f=[],c=0,d=e.length;d>c;c++)a=e[c],f.push(b(a));return f}.call(this))},a.prototype.isInView=function(a){var b,c,d;if(b=this.getPathInfo(a),!b)throw new Error("Invalid path: "+a);return b.isAttribute()?(d=b.toString(),_.call(this.views,d)>=0):(c=b.toString(),S.any(this.getViewNodes(),function(a){return a.toString()===c}))},a.prototype.isConstrained=function(a,b){var c,d;if(null==b&&(b=!1),c=this.getPathInfo(a),!c)throw new Error("Invalid path: "+a);return d=function(a){return null!=a.op&&a.path===c.toString()},!c.isAttribute()&&b&&(d=function(a){return function(b){return null!=b.op&&(b.path===c.toString()||c.equals(a.getPathInfo(b.path).getParent()))}}(this)),S.any(this.constraints,d)},a.prototype.canHaveMultipleValues=function(a){return this.getPathInfo(a).containsCollection()},a.prototype.getQueryNodes=function(){var a,b,c,d;return d=this.getViewNodes(),b=function(){var b,d,e,f;for(e=this.constraints,f=[],b=0,d=e.length;d>b;b++)a=e[b],null==a.type&&(c=this.getPathInfo(a.path),c.isAttribute()?f.push(c.getParent()):f.push(c));return f}.call(this),S.uniqBy(String,d.concat(b))},a.prototype.isInQuery=function(a){var b,c,d,e,f,g;if(c=this.getPathInfo(a)){for(d=c.toPathString(),g=this.views.concat(function(){var a,c,d,e;for(d=this.constraints,e=[],a=0,c=d.length;c>a;a++)b=d[a],
null==b.type&&e.push(b.path);return e}.call(this)),e=0,f=g.length;f>e;e++)if(a=g[e],0===a.indexOf(d))return!0;return!1}return!0},a.prototype.isRelevant=function(a){var b,c,d;return c=this.getPathInfo(a),c.isAttribute()&&(c=c.getParent()),d=c.toString(),b=this.getViewNodes(),S.any(b,function(a){return a.toPathString()===d})},a.prototype.expandStar=function(a){var b,c,d,e,f,g,h,i;if(/\*$/.test(a))if(h=a.substr(0,a.lastIndexOf(".")),d=function(a){return h+a},c=this.getType(h),/\.\*$/.test(a)){if(c&&this.summaryFields[c.name])return e=S.compose(d,r),function(){var a,b,d,g;for(d=this.summaryFields[c.name],g=[],a=0,b=d.length;b>a;a++)f=d[a],this.hasView(f)||g.push(e(f));return g}.call(this)}else if(/\.\*\*$/.test(a))return i=this.expandStar(h+".*"),b=function(){var a;a=[];for(g in c.attributes)a.push(d("."+g));return a}(),S.uniqBy(z,i.concat(b));return a},a.prototype.isOuterJoin=function(a){return"OUTER"===this.joins[this.adjustPath(a)]},a.prototype.hasView=function(a){var b;return this.views&&(b=this.adjustPath(a),_.call(this.views,b)>=0)},a.prototype.count=function(a){if(this.service.count)return this.service.count(this,a);throw new Error("This query has no service with count functionality attached.")},a.prototype.appendToList=function(a,b){var c,d,e,g,h;return(null!=a?a.name:void 0)?(c=a.name,h=function(b,c){return null==b?a.size=c.size:void 0}):(c=String(a),h=null),g=this.makeListQuery(),e={listName:c,query:g.toXML()},d=f(this.service),T(h,b,this.service.post("query/append/tolist",e).then(d))},a.prototype.selectPreservingImpliedConstraints=function(a){var b,c,d,e,f;for(null==a&&(a=[]),c=this.clone(),c.select(a),f=this.getViewNodes(),d=0,e=f.length;e>d;d++)b=f[d],this.isOuterJoined(b)||c.isInView(b||c.isConstrained(b))||null==b.getEndClass().fields.id||c.addConstraint([b.append("id"),"IS NOT NULL"]);return c},a.prototype.makeListQuery=function(){var a,b;return a=this.views.slice(),1===a.length&&(null!=(b=a[0])?b.match(/\.id$/):void 0)||(a=["id"]),this.selectPreservingImpliedConstraints(a)},a.prototype.saveAsList=function(a,b){var c,d;return d=this.makeListQuery(),c=S.copy(a),c.listName=c.listName||c.name,c.query=d.toXML(),a.tags&&(c.tags=a.tags.join(";")),T(b,this.service.post("query/tolist",c).then(f(this.service)))},a.prototype.summarise=function(a,b,c){return this.filterSummary(a,"",b,c)},a.prototype.summarize=function(){var a;return a=1<=arguments.length?ba.call(arguments,0):[],this.summarise.apply(this,a)},g=function(a){var b,c,d,e,f,g,h;for(b=null!=(null!=(g=a.results[0])?g.max:void 0),h=a.results,e=0,f=h.length;f>e;e++)c=h[e],c.count=parseInt(c.count,10);return d={uniqueValues:a.uniqueValues,filteredCount:a.filteredCount},b&&(d=F(d,a.results[0])),a.stats=d,a},a.prototype.filterSummary=function(a,b,c,d){var e,f,h;return null==d&&(d=function(){}),S.isFunction(c)&&(h=[c,null],d=h[0],c=h[1]),a=this.adjustPath(a),f=this.clone(),_.call(f.views,a)<0&&f.views.push(a),e={query:f.toXML(),summaryPath:a,format:"jsonrows"},c&&(e.size=c),b&&(e.filterTerm=b),T(d,this.service.post("query/results",e).then(g))},a.prototype.clone=function(b){var c,d,e,f;if(c=new a(this,this.service),null==c._callbacks&&(c._callbacks={}),b){f=this._callbacks;for(d in f)ca.call(f,d)&&(e=f[d],c._callbacks[d]=e);c.off("change:views",L,this)}return c},a.prototype.next=function(){var a;return a=this.clone(),this.maxRows&&(a.start=this.start+this.maxRows),a},a.prototype.previous=function(){var a;return a=this.clone(),this.maxRows?a.start=this.start-this.maxRows:a.start=0,a},a.prototype.getSortDirection=function(a){var b,c;if(b=this.adjustPath(a),!this.isInQuery(b)&&!this.isRelevant(b))throw new Error(""+a+" is not in the query");return c=S.find(this.sortOrder,function(a){var c;return c=a.path,b===c}),null!=c?c.direction:void 0},a.prototype.isOuterJoined=function(a){var b,c,d;a=this.adjustPath(a),d=this.joins;for(c in d)if(b=d[c],"OUTER"===b&&0===a.indexOf(c))return!0;return!1},a.prototype.getOuterJoin=function(a){var b,c;return a=this.adjustPath(a),b=function(){var a;a=[];for(c in this.joins)a.push(c);return a}.call(this).sort(function(a,b){return b.length-a.length}),S.find(b,function(b){return function(c){return"OUTER"===b.joins[c]&&0===a.indexOf(c)}}(this))},a.prototype._parse_sort_order=function(a){var b,c,d,e,f,g;if(null==a)throw new Error("No input");if("string"==typeof a)e={path:a,direction:"ASC"};else if(S.isArray(a))d=a[0],b=a[1],e={path:d,direction:b};else if(null==a.path){for(c in a)f=a[c],g=[c,f],d=g[0],b=g[1];e={path:d,direction:b}}else d=a.path,b=a.direction,e={path:d,direction:b};return e.path=this.adjustPath(e.path),null==e.direction&&(e.direction="ASC"),e.direction=e.direction.toUpperCase(),e},a.prototype.addOrSetSortOrder=function(a){var b,c;return a=this._parse_sort_order(a),b=this.getSortDirection(a.path),null==b?this.addSortOrder(a):b!==a.direction&&(c=S.find(this.sortOrder,function(b){var c;return c=b.path,c===a.path}),c.direction=a.direction,this.trigger("change:sortorder",this.sortOrder),this.trigger("change")),this},a.prototype.addSortOrder=function(a,b){var c;return c=(null!=b?b:{}).silent,this.sortOrder.push(this._parse_sort_order(a)),c?void 0:(this.trigger("add:sortorder",a),this.trigger("change:sortorder",this.sortOrder),this.trigger("change"))},a.prototype.orderBy=function(a,b){var c,d,e,f,g,h,i,j;for(null==b&&(b={}),f=this.sortOrder.slice(),this.sortOrder=[],h=0,i=a.length;i>h;h++)e=a[h],this.addSortOrder(this._parse_sort_order(e),{silent:!0});return c=function(){var a,b,c,e,f;for(c=this.sortOrder,f=[],a=0,b=c.length;b>a;a++)e=c[a],g=e.path,d=e.direction,f.push({path:g,direction:d});return f}.call(this),this.trigger("set:sortorder",c),O(f)!==this.getSorting()&&(b.silent?b.events=(null!=(j=b.events)?j:[]).concat(["change","change:sortorder"]):(this.trigger("change:sortorder",c),this.trigger("change"))),this},a.prototype.addJoins=function(a){var b,c,d,e,f,g,h;if(S.isArray(a)){for(g=[],e=0,f=a.length;f>e;e++)b=a[e],g.push(this.addJoin(b));return g}h=[];for(c in a)d=a[c],h.push(this.addJoin({path:c,style:d}));return h},a.prototype.addJoin=function(a){return"string"==typeof a&&(a={path:a,style:"OUTER"}),this.setJoinStyle(a.path,a.style)},a.prototype.setJoinStyle=function(b,c){if(null==c&&(c="OUTER"),b=this.adjustPath(b),c=c.toUpperCase(),_.call(a.JOIN_STYLES,c)<0)throw new Error("Invalid join style: "+c);return this.joins[b]!==c&&(this.joins[b]=c,this.trigger("change:joins",{path:b,style:c}),this.trigger("change")),this},a.prototype.addConstraints=function(a,b){var c,d,e,f,g,h,i;if(null==b&&(b="and"),this.__silent__=!0,e=this.constraintLogic,S.isArray(a))for(h=0,i=a.length;i>h;h++)c=a[h],this.addConstraint(c,b);else{g=function(a){return function(c,d){return a.addConstraint(D(c,d),b)}}(this);for(f in a)d=a[f],g(f,d)}return this.__silent__=!1,this.trigger("add:constraint"),this.trigger("change:constraints"),e!==this.constraintLogic&&this.trigger("change:logic",this.constraintLogic),this.trigger("change")},a.prototype.addConstraint=function(a,b){var c,e,f,g,h,i,j;if(null==b&&(b="and"),"and"!==b&&"or"!==b)throw new Error("Unknown logical conjunction: "+b);return a=S.isArray(a)?C(a):q(a),"OFF"===a.switched?this:(a.path=this.adjustPath(a.path),null==a.type&&(a.op=x(a.op)),this.constraints.push(a),f="or"===b||(null!=(j=this.constraintLogic)?j.length:void 0)>0,g=this.constraints.length,i=this.constraintLogic,f&&(h=2===g?""+d[0]+" "+b+" "+d[1]:(e=this.constraintLogic,e||(e=function(){var a,b,e;for(e=[],c=a=0,b=g-2;b>=0?b>=a:a>=b;c=b>=0?++a:--a)e.push(d[c]);return e}().join(" and ")),"("+e+") "+b+" "+d[g-1]),this.constraintLogic=h),this.__silent__||(this.trigger("add:constraint",a),this.trigger("change:constraints"),i!==this.constraintLogic&&this.trigger("change:logic",this.constraintLogic),this.trigger("change")),this)},a.prototype.getSorting=function(){return O(this.sortOrder)},a.prototype.getConstraintXML=function(){var a,b;return b=function(){var b,c,d,e;for(d=this.constraints,e=[],b=0,c=d.length;c>b;b++)a=d[b],(null==a.type||this.isInQuery(a.path))&&e.push(a);return e}.call(this),b.length?p(m)(p(z)(K(function(a){return null!=a.type})(b))):""},a.prototype.getJoinXML=function(){var a,b,c;return c=function(){var c,d;c=this.joins,d=[];for(a in c)b=c[a],this.isInQuery(a)&&"OUTER"===b&&d.push('<join path="'+a+'" style="OUTER"/>');return d}.call(this),c.join("")},a.prototype.toXML=function(){var a,b,c,d;return a={model:this.model.name,view:this.views.join(" "),sortOrder:this.getSorting(),constraintLogic:this.constraintLogic},null!=this.name&&(a.name=this.name),b=function(){var b;b=[];for(c in a)d=a[c],d&&b.push(c+'="'+d+'"');return b}().join(" "),"<query "+b+" >"+this.getJoinXML()+this.getConstraintXML()+"</query>"},a.prototype.toJSON=function(){var a,b,c,d,e;return I({name:this.name,title:this.title,comment:this.comment,description:this.description,constraintLogic:this.constraintLogic,from:this.root,select:function(){var a,b,c,d;for(c=this.views,d=[],a=0,b=c.length;b>a;a++)e=c[a],d.push(y(e));return d}.call(this),orderBy:function(){var a,d,e,f,g;for(e=this.sortOrder,g=[],a=0,d=e.length;d>a;a++)f=e[a],c=f.path,b=f.direction,g.push({path:y(c),direction:b});return g}.call(this),joins:function(){var a,b;a=this.joins,b=[];for(c in a)d=a[c],"OUTER"===d&&b.push(y(c));return b}.call(this),where:function(){var b,c,d,e;for(d=this.constraints,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(n(a));return e}.call(this)})},a.prototype.fetchCode=function(a,b){var c;return c={query:this.toXML(),lang:a},T(b,this.service.post("query/code",c).then(this.service.VERIFIER).then(w("code")))},a.prototype.setName=function(a){this.name=a},a.prototype.save=function(a,b){return h(this.service,16,function(c){return function(){var d,e;return S.isFunction(a)&&(e=[null,a],a=e[0],b=e[1]),null!=a&&c.setName(a),d={type:"PUT",path:"user/queries",data:c.toXML(),contentType:"application/xml",dataType:"json"},T(b,c.service.authorise(d)).then(function(a){return c.service.doReq(a)}).then(function(a){return a.queries})}}(this))},a.prototype.store=function(a,b){return h(this.service,16,function(c){return function(){var d,e,f,g;return S.isFunction(a)&&(g=[null,a],a=g[0],b=g[1]),null!=a&&c.setName(a),f=function(a,b){return null==a?c.setName(b):void 0},d=S.compose(w(c.name),w("queries")),e={type:"POST",path:"user/queries",data:c.toXML(),contentType:"application/xml",dataType:"json"},T(b,f,c.service.authorise(e)).then(function(a){return c.service.doReq(a)}).then(d)}}(this))},a.prototype.saveAsTemplate=function(a,b){return h(this.service,16,function(c){return function(){var d,e;if(S.isFunction(a)&&(e=[null,a],a=e[0],b=e[1]),null!=a&&c.setName(a),!c.name)throw new Error("Templates must have a name");return d={type:"POST",path:"templates",data:"<template "+l(c,["name","title","comment"])+">"+c.toXML()+"</template>",contentType:"application/xml",dataType:"json"},T(b,c.service.authorise(d).then(function(a){return c.service.doReq(a)}))}}(this))},a.prototype.getCodeURI=function(a){var b,c;return b={query:this.toXML(),lang:a,format:"text"},null!=(null!=(c=this.service)?c.token:void 0)&&(b.token=this.service.token),""+this.service.root+"query/code?"+P(b)},a.prototype.getExportURI=function(b,c){var d,e;return null==b&&(b="tab"),null==c&&(c={}),_.call(a.BIO_FORMATS,b)>=0?this["get"+b.toUpperCase()+"URI"](c):(d=F(c,{query:this.toXML(),format:b}),null!=(null!=(e=this.service)?e.token:void 0)&&(d.token=this.service.token),""+this.service.root+"query/results?"+P(d))},a.prototype.needsAuthentication=function(){return S.any(this.constraints,function(a){var b;return"NOT IN"===(b=a.op)||"IN"===b})},a.prototype.fetchQID=function(a){return T(a,this.service.post("queries",{query:this.toXML()}).then(w("id")))},b=function(a){return a.append("primaryIdentifier").toString()},a.prototype.__bio_req=function(a,c){var d,e;return e=this.makeListQuery(),d=function(b){return S.any(a,function(a){return b.isa(a)})},e.views=S.take(c)(function(){var a,e,f,g;for(f=this.getViewNodes(),g=[],a=0,e=f.length;e>a;a++)c=f[a],d(c)&&g.push(b(c));return g}.call(this)),{query:e.toXML(),format:"text"}},a.prototype._fasta_req=function(){return this.__bio_req(["SequenceFeature","Protein"],1)},a.prototype._gff3_req=function(){return this.__bio_req(["SequenceFeature"])},a.prototype._bed_req=a.prototype._gff3_req,a}(),R=v(function(a,b){return a.concat(b)}),g.prototype.toString=g.prototype.toXML,g.ATTRIBUTE_OPS=R([g.ATTRIBUTE_VALUE_OPS,g.MULTIVALUE_OPS,g.NULL_OPS]),g.REFERENCE_OPS=R([g.TERNARY_OPS,g.LOOP_OPS,g.LIST_OPS]),k=function(a,b){return function(c,d){var e,f,g,h,i;return null==c&&(c={}),null==d&&(d=function(){}),S.isFunction(c)&&(i=[{},c],c=i[0],d=i[1]),e=function(a){return function(b){var c;return c=a.getPathInfo(b),c.isAttribute()?c:c.append("id")}}(this),null!=(null!=c?c.view:void 0)&&(c.view=function(){var a,b,d,e;for(d=c.view,e=[],a=0,b=d.length;b>a;a++)h=d[a],e.push(this.getPathInfo(h).toString());return e}.call(this)),f=null!=c["export"]?this.selectPreservingImpliedConstraints(c["export"].map(e)):this,g=F(f[a](),c),b.call(f,g,d)}},$=g.BIO_FORMATS,U=function(a){var b,c,d;return c="_"+a+"_req",b="get"+a.toUpperCase(),d=b+"URI",g.prototype[b]=k(c,function(b,c){return T(c,this.service.post("query/results/"+a,b))}),g.prototype[d]=k(c,function(b,c){return null!=this.service.token&&(b.token=this.service.token),""+this.service.root+"query/results/"+a+"?"+P(b)})};for(W=0,Y=$.length;Y>W;W++)t=$[W],U(t);for(V=function(a){return function(){var b,c,d,e;if(c=arguments[0],b=2<=arguments.length?ba.call(arguments,1):[],this.service[a])return null==c?c={}:S.isFunction(c)&&(c={},b=function(){var a,b,c;for(c=[],a=0,b=arguments.length;b>a;a++)d=arguments[a],c.push(d);return c}.apply(this,arguments)),c=I(F({start:this.start,size:this.maxRows},c)),(e=this.service)[a].apply(e,[this,c].concat(ba.call(b)));throw new Error("Service does not provide '"+a+"'.")}},X=0,Z=i.length;Z>X;X++)G=i[X],g.prototype[G]=V(G);e.mixin(g.prototype),g.prototype.emit=g.prototype.trigger,g.prototype.bind=g.prototype.on,B.Query=g}).call(this)},{"./util":15,"./xml":17,"backbone-events-standalone":22}],10:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa=function(a,b){return function(){return a.apply(b,arguments)}},pa={}.hasOwnProperty,qa=[].slice;for(x=a("./promise"),s=a("./model").Model,A=a("./query").Query,p=a("./lists").List,N=a("./user").User,k=a("./id-resolution-job").IDResolutionJob,fa=a("./version"),ea=a("./util"),Y=a("./http"),da=ea.querystring,ga=ea.withCB,$=ea.map,_=ea.merge,W=ea.get,ba=ea.set,Z=ea.invoke,ca=ea.success,V=ea.error,D=ea.REQUIRES_VERSION,U=ea.dejoin,O={},d={},B={},q={},H={},R={},g="http://",P="version",K="templates",C="version/release",e="classkeys",m="lists",r="model",G="summaryfields",y="query/results",z="search",S="widgets",h="list/enrichment",T="listswithobject",n={union:"lists/union",intersection:"lists/intersect",difference:"lists/diff"},E="lists/subtract",Q="user/whoami",J=y+"/tablerows",w="user/preferences",v="path/values",M="user/tokens",l="ids",u={},ma=[P,C,e,S,r,G,z,v],ia=0,ka=ma.length;ka>ia;ia++)aa=ma[ia],u[aa]=!0;for(b={},na=[Q,w,n,E,T,h,K,M],ja=0,la=na.length;la>ja;ja++)aa=na[ja],b[aa]=!0;t=function(a,c){return u[a]?!1:b[a]?!0:(null!=c?c.needsAuthentication:void 0)?c.needsAuthentication():!0},i=/^https?:\/\//i,j=/service\/?$/i,F="/service/",f=function(a){var b,c;return(b=null!=(c=console.error)?c:console.log)(a)},ha=function(a,b,c,d,e){var f,g,h,i,j;return h=this.root,i=this.useCache,g=null!=this[a]?this[a]:this[a]=i&&(j=b[h])?ca(j):(f={type:"GET",dataType:"json",data:{format:"json"}},this.doReq(_(f,{url:this.root+c})).then(function(a){return b[h]=a[d]})),ga(e,g)},X=function(a){return function(b){return new x(function(c,d){var e;return(e=ea.find(b,function(b){return b.name===a}))?c(e):d('List "'+a+'" not found among: '+b.map(W("name")))})}},o=function(a,b){return null==b&&(b="listName"),ea.compose(a.fetchList,W(b))},L=function(a){var b,c,d,e,f,g;for(null==a&&(a=[]),e=ea.isArray(a)?a:[a],g=[],c=0,d=e.length;d>c;c++)b=e[c],g.push(null!=(f=b.name)?f:b);return g},I=function(){function a(a){var b;if(this.root=a.root,this.token=a.token,this.errorHandler=a.errorHandler,this.DEBUG=a.DEBUG,this.help=a.help,b=a.noCache,this.headers=a.headers,this.connectAs=oa(this.connectAs,this),this.createList=oa(this.createList,this),this.resolveIds=oa(this.resolveIds,this),this.templateQuery=oa(this.templateQuery,this),this.savedQuery=oa(this.savedQuery,this),this.query=oa(this.query,this),this.fetchRelease=oa(this.fetchRelease,this),this.fetchClassKeys=oa(this.fetchClassKeys,this),this.fetchVersion=oa(this.fetchVersion,this),this.fetchSummaryFields=oa(this.fetchSummaryFields,this),this.fetchModel=oa(this.fetchModel,this),this.fetchWidgetMap=oa(this.fetchWidgetMap,this),this.fetchWidgets=oa(this.fetchWidgets,this),this.complement=oa(this.complement,this),this.fetchListsContaining=oa(this.fetchListsContaining,this),this.fetchList=oa(this.fetchList,this),this.findLists=oa(this.findLists,this),this.fetchLists=oa(this.fetchLists,this),this.fetchTemplates=oa(this.fetchTemplates,this),this.tableRows=oa(this.tableRows,this),this.values=oa(this.values,this),this.rows=oa(this.rows,this),this.records=oa(this.records,this),this.table=oa(this.table,this),this.pathValues=oa(this.pathValues,this),this.fetchUser=oa(this.fetchUser,this),this.whoami=oa(this.whoami,this),this.findById=oa(this.findById,this),this.count=oa(this.count,this),this.enrichment=oa(this.enrichment,this),null==this.root)throw new Error("No service root provided. This is required");i.test(this.root)||(this.root=g+this.root),j.test(this.root)||(this.root=this.root+F),this.root=this.root.replace(/ice$/,"ice/"),null==this.headers&&(this.headers=null),null==this.errorHandler&&(this.errorHandler=f),null==this.help&&(this.help="no.help.available@dev.null"),this.useCache=!b,this.getFormat=function(a){return function(a){return null==a&&(a="json"),a}}(this)}var b,c,u,x,I,M;return a.prototype.doReq=function(){return arguments[0]=this.attachCustomHeaders(arguments[0]),Y.doReq.apply(this,arguments)},a.prototype.post=function(a,b){return this.makeRequest("POST",a,b)},a.prototype.get=function(a,b){return this.makeRequest("GET",a,b)},a.prototype.makeRequest=function(a,b,c,d,e){var f,g,h,i,j,k,l;return null==a&&(a="GET"),null==b&&(b=""),null==c&&(c={}),null==d&&(d=function(){}),null==e&&(e=!1),ea.isArray(d)&&(j=d,d=j[0],g=j[1]),ea.isArray(c)&&(c=ea.pairsToObj(c)),null==g&&(g=this.errorHandler),c=ea.copy(c),f=this.getFormat(c.format),Y.supports(a)||(k=[a,Y.getMethod(a)],c.method=k[0],a=k[1]),h={data:c,dataType:f,success:d,error:g,path:b,type:a},null!=c.auth&&(h.auth=c.auth,delete h.data.auth),null!=c.headers&&(h.headers=ea.copy(c.headers),delete h.data.headers),(i=null!=(l=c.timeout)?l:this.timeout)&&(h.timeout=i,delete c.timeout),this.authorise(h).then(function(a){return function(b){return a.doReq(b,e)}}(this))},a.prototype.authorise=function(a){return this.fetchVersion().then(function(b){return function(c){var d,e,f;return d=ea.copy(a),null==d.headers&&(d.headers={}),d.url=b.root+d.path,e=[],14>c&&("string"==typeof d.data?e.push(["format",d.dataType]):d.data.format=d.dataType),null!=b.token&&t(a.path,null!=(f=d.data)?f.query:void 0)&&(c>=14?d.headers.Authorization="Token "+b.token:"string"==typeof d.data?e.push(["token",b.token]):d.data.token=b.token),e.length&&(d.url+="?"+da(e)),d}}(this))},a.prototype.attachCustomHeaders=function(a){var b;return null!=this.headers?(b=ea.copy(a),b.headers=ea.merge(b.headers,this.headers),b):a},a.prototype.enrichment=function(a,b){return D(this,8,function(c){return function(){var d;return d=_({maxp:.05,correction:"Holm-Bonferroni"},a),ga(b,c.get(h,d).then(W("results")))}}(this))},a.prototype.search=function(a,b){return null==a&&(a={}),null==b&&(b=function(){}),D(this,9,function(c){return function(){var d,e,f,g;if(ea.isFunction(a)&&(g=[a,{}],b=g[0],a=g[1]),"string"==typeof a)e={q:a};else{e={q:a.q};for(d in a)pa.call(a,d)&&(f=a[d],"q"!==d&&(e["facet_"+d]=f))}return ga(b,c.post(z,e))}}(this))},a.prototype.makePath=function(a,b,c){return null==b&&(b={}),null==c&&(c=function(){}),ga(c,this.fetchModel().then(function(c){return c.makePath(a,b)}))},a.prototype.count=function(a,b){var c,d;return null==b&&(b=function(){}),c=a?null!=a.toPathString?(aa=a.isClass()?a.append("id"):a,this.pathValues(aa,"count")):null!=a.toXML?(d={query:a,format:"jsoncount"},this.post(y,d).then(W("count"))):"string"==typeof a?this.fetchModel().then(function(b){return function(c){var d;try{return b.count(c.makePath(a))}catch(e){return d=e,b.query({select:[a]}).then(b.count)}}}(this)):this.query(a).then(this.count):V("Not enough arguments"),ga(b,c)},a.prototype.findById=function(a,b,c,d){var e,f;return null==c&&(c=["**"]),null==d&&(d=function(){}),ea.isFunction(c)&&(f=[["**"],c],c=f[0],d=f[1]),e=this.query({from:a,select:c,where:{id:b}}).then(U).then(Z("records")).then(W(0)),ga(d,e)},a.prototype.lookup=function(a,b,c,d){var e,f;return ea.isFunction(c)&&(f=[null,c],c=f[0],d=f[1]),e=this.query({from:a,select:["**"],where:[[a,"LOOKUP",b,c]]}).then(U).then(Z("records")),ga(d,e)},a.prototype.find=function(a,b,c,d){var e;return ea.isFunction(c)&&(e=[null,c],c=e[0],d=e[1]),ga(d,this.lookup(a,b,c).then(function(a){return null==a||0===a.length?V("Nothing found"):a.length>1?V("Multiple items found: "+a.slice(0,3)+"..."):ca(a[0])}))},a.prototype.whoami=function(a){return D(this,9,function(b){return function(){return ga(a,b.get(Q).then(W("user")).then(function(a){return new N(b,a)}))}}(this))},a.prototype.fetchUser=function(){var a;return a=1<=arguments.length?qa.call(arguments,0):[],this.whoami.apply(this,a)},I=function(a,b){return{format:a,path:String(b),typeConstraints:JSON.stringify(b.subclasses)}},a.prototype.pathValues=function(a,b,c){return null==b&&(b={}),D(this,6,function(d){return function(){var e,f,g,h,i;return"string"==typeof b&&(h=b,b={}),ea.isFunction(b)&&(i=[c,b],b=i[0],c=i[1]),"count"!==h&&(h="results"),f="count"===h?"jsoncount":"json",g=function(){var c;try{return this.fetchModel().then(Z("makePath",a,null!=(c=a.subclasses)?c:b)).then(function(a){return I(f,a)}).then(function(a){return function(b){return a.post(v,b)}}(this)).then(W(h))}catch(d){return e=d,V(e)}}.call(d),ga(c,g)}}(this))},a.prototype.doPagedRequest=function(a,b,c,d,e){var f,g;return null==c&&(c={}),null==e&&(e=function(){}),null!=a.toXML?(ea.isFunction(c)&&(g=[c,{}],e=g[0],c=g[1]),f=_(c,{query:a,format:d}),ga(e,this.post(b,f).then(W("results")))):this.query(a).then(function(a){return function(f){return a.doPagedRequest(f,b,c,d,e)}}(this))},a.prototype.table=function(a,b,c){return this.doPagedRequest(a,y,b,"jsontable",c)},a.prototype.records=function(a,b,c){return this.doPagedRequest(a,y,b,"jsonobjects",c)},a.prototype.rows=function(a,b,c){return this.doPagedRequest(a,y,b,"json",c)},a.prototype.values=function(a,b,c){var d,e;return ea.isFunction(b)&&(e=[b,c],c=e[0],b=e[1]),d=null==a?V("No query term supplied"):null!=a.descriptors||"string"==typeof a?this.pathValues(a,b).then($(W("value"))):null!=a.toXML?1!==a.views.length?V("Expected one column, got "+a.views.length):this.rows(a,b).then($(W(0))):this.query(a).then(function(a){return function(c){return a.values(c,b)}}(this)),ga(c,d)},a.prototype.tableRows=function(a,b,c){return this.doPagedRequest(a,J,b,"json",c)},a.prototype.fetchTemplates=function(a){return ga(a,this.get(K).then(W("templates")))},a.prototype.fetchLists=function(a){return this.findLists("",a)},a.prototype.findLists=function(a,b){return null==a&&(a=""),null==b&&(b=function(){}),this.fetchVersion().then(function(c){return function(d){var e;return ga(b,a&&13>d?V("Finding lists by name on the server requires version 13. This is only "+d):(e=function(a){var b,d,e,f;for(f=[],d=0,e=a.length;e>d;d++)b=a[d],f.push(new p(b,c));return f},c.get(m,{name:a}).then(W("lists")).then(e)))}}(this))},a.prototype.fetchList=function(a,b){return this.fetchVersion().then(function(c){return function(d){return ga(b,13>d?c.findLists().then(X(a)):c.findLists(a).then(W(0)))}}(this))},a.prototype.fetchListsContaining=function(a,b){var c;return c=function(a){return function(b){var c,d,e,f;for(f=[],d=0,e=b.length;e>d;d++)c=b[d],f.push(new p(c,a));return f}}(this),ga(b,this.get(T,a).then(W("lists")).then(c))},a.prototype.combineLists=function(a,b,c){var d,e,f,g,h,i;return i=_({lists:[],tags:[]},b),f=i.name,e=i.lists,h=i.tags,d=i.description,g={name:f,description:d},null==g.description&&(g.description=""+a+" of "+e.join(", ")),g.tags=h.join(";"),g.lists=e.join(";"),ga(c,this.get(n[a],g).then(o(this)))},a.prototype.merge=function(){return this.combineLists.apply(this,["union"].concat(qa.call(arguments)))},a.prototype.intersect=function(){return this.combineLists.apply(this,["intersection"].concat(qa.call(arguments)))},a.prototype.diff=function(){return this.combineLists.apply(this,["difference"].concat(qa.call(arguments)))},a.prototype.complement=function(a,b){var c,d,e,f,g,h,i,j,k;return null==a&&(a={}),null==b&&(b=function(){}),f=a.from,e=a.exclude,h=a.name,d=a.description,k=a.tags,c=function(){return"Relative complement of "+g.join(" and ")+" in "+i.join(" and ")},i=L(f),g=L(e),null==h&&(h=c()),null==d&&(d=c()),null==k&&(k=[]),j={name:h,description:d,tags:k,lists:g,references:i},ga(b,this.post(E,j).then(o(this)))},a.prototype.fetchWidgets=function(a){return D(this,8,function(b){return function(){return ha.call(b,"widgets",R,S,"widgets",a)}}(this))},M=ea.omap(function(a){return[a.name,a]}),a.prototype.fetchWidgetMap=function(a){return D(this,8,function(b){return function(){return ga(a,null!=b.__wmap__?b.__wmap__:b.__wmap__=b.fetchWidgets().then(M))}}(this))},a.prototype.fetchModel=function(a){var b;return b=ha.call(this,"model",q,r,"model").then(s.load).then(ba({service:this})),ga(a,b)},a.prototype.fetchSummaryFields=function(a){return ha.call(this,"summaryFields",H,G,"classes",a)},a.prototype.fetchVersion=function(a){return ha.call(this,"version",O,P,"version",a)},a.prototype.fetchClassKeys=function(a){return ha.call(this,"classkeys",d,e,"classes",a)},a.prototype.fetchRelease=function(a){return ha.call(this,"release",B,C,"version",a)},a.prototype.query=function(a,b){var c;return c=function(b){return function(c){var d,e;return d=c[0],e=c[1],new A(a,b,{model:d,summaryFields:e})}}(this),ga(b,ea.parallel(this.fetchModel(),this.fetchSummaryFields()).then(c))},x=function(a,b){return function(c){return c?a.query(c):V("No query found called "+b)}},c=function(a){return a?"string"==typeof a?ca():V("Name must be a string"):V("Name not provided")},a.prototype.savedQuery=function(a,b){return D(this,16,function(d){return function(){return c(a).then(function(){return ga(b,d.get("user/queries",{filter:a}).then(function(b){return b.queries[a]}).then(x(d,a)))})}}(this))},a.prototype.templateQuery=function(a,b){return c(a).then(function(c){return function(){return ga(b,c.fetchTemplates().then(W(a)).then(ba("type","TEMPLATE")).then(x(c,a)))}}(this))},a.prototype.manageUserPreferences=function(a,b,c){return D(this,11,function(d){return function(){return ga(c,d.makeRequest(a,w,b).then(W("preferences")))}}(this))},a.prototype.resolveIds=function(a,b){return D(this,10,function(c){return function(){var d;return d={type:"POST",url:c.root+l,contentType:"application/json",data:JSON.stringify(a),dataType:"json"},ga(b,c.doReq(d).then(W("uid")).then(k.create(c)))}}(this))},a.prototype.resolutionJob=function(a){return k.create(this)(a)},a.prototype.createList=function(a,b,c){var d,e;return null==a&&(a={}),null==b&&(b=""),null==c&&(c=function(){}),d=function(b){return function(c){return _(c,{token:b.token,tags:a.tags||[]})}}(this),e={data:ea.isArray(b)?b.map(function(a){return'"'+a+'"'}).join("\n"):b,dataType:"json",url:""+this.root+"lists?"+da(d(a)),type:"POST",contentType:"text/plain"},ga(c,this.doReq(e).then(o(this)))},u=function(a){return a.user.temporaryToken},a.prototype.connectAs=function(b){return a.connect(_(this,{token:b,noCache:!this.useCache}))},a.prototype.register=function(a,b,c){return D(this,9,function(d){return function(){return ga(c,d.post("users",{name:a,password:b}).then(u).then(d.connectAs))}}(this))},b=300,a.prototype.getDeregistrationToken=function(a,c){return null==a&&(a=b),D(this,16,function(b){return function(){var d;return d=null!=b.token?b.post("user/deregistration",{validity:a}).then(W("token")):V("Not registered"),ga(c,d)}}(this))},a.prototype.deregister=function(a,b){return D(this,16,function(c){return function(){return ga(b,c.makeRequest("DELETE","user",{deregistrationToken:a,format:"xml"}))}}(this))},a.prototype.login=function(a,b,c){return D(this,9,function(d){return function(){var e;return e=""+a+":"+b,ga(c,d.logout().then(function(a){return a.get("user/token",{auth:e})})).then(W("token")).then(d.connectAs)}}(this))},a.prototype.logout=function(a){return ga(a,ca(this.connectAs()))},a}(),I.prototype.rowByRow=function(){var a,b,c;return c=arguments[0],a=2<=arguments.length?qa.call(arguments,1):[],b=Y.iterReq("POST",y,"json"),null!=c.toXML?b.apply(this,arguments):this.query(c).then(function(b){return function(c){return b.rowByRow.apply(b,[c].concat(qa.call(a)))}}(this))},I.prototype.eachRow=I.prototype.rowByRow,I.prototype.recordByRecord=function(){var a,b,c;return c=arguments[0],a=2<=arguments.length?qa.call(arguments,1):[],b=Y.iterReq("POST",y,"jsonobjects"),null!=c.toXML?b.apply(this,arguments):this.query(c).then(function(b){return function(c){return b.recordByRecord.apply(b,[c].concat(qa.call(a)))}}(this))},I.prototype.eachRecord=I.prototype.recordByRecord,I.prototype.union=I.prototype.merge,I.prototype.difference=I.prototype.diff,I.prototype.symmetricDifference=I.prototype.diff,I.prototype.relativeComplement=I.prototype.complement,I.prototype.subtract=I.prototype.complement,I.flushCaches=function(){return q={},O={},B={},d={},H={},R={}},I.connect=function(a){if(null==(null!=a?a.root:void 0))throw new Error("Invalid options provided: "+JSON.stringify(a));return new I(a)},c.Service=I,c.Model=s,c.Query=A,c.utils=ea,c.VERSION=fa.VERSION,c.imjs=fa}).call(this)},{"./http":3,"./id-resolution-job":4,"./lists":5,"./model":6,"./promise":8,"./query":9,"./user":14,"./util":15,"./version":16}],11:[function(a,b,c){(function(a){(function(){var b;c.DOMParser=null!=a.DOMParser?a.DOMParser:b=function(){function a(){throw new Error("DOMParser is not available")}return a}()}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],12:[function(a,b,c){(function(){var a,b,c,d,e,f,g,h,i,j,k,l;if(a="undefined"!=typeof console,b="undefined"!=typeof JSON,c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],b||(h=document.createElement("script"),h.src="http://cdn.intermine.org/js/json3/3.2.2/json3.min.js",h.type="text/javascript",f=document.getElementsByTagName("head")[0],f.appendChild(h)),null==Object.keys&&(e=Object.prototype.hasOwnProperty,d=!{toString:null}.propertyIsEnumerable("toString"),Object.keys=function(a){var b,f,g,h,i;if("object"!=typeof a&&""!=typeof a||null===a)throw new TypeError("Object.keys called on a non-object");if(b=function(){var b;b=[];for(f in a)e.call(a,f)&&b.push(f);return b}(),d)for(h=0,i=c.length;i>h;h++)g=c[h],e.call(a,g)&&b.push(g);return b}),null==Array.prototype.map&&(Array.prototype.map=function(a){var b,c,d,e;for(e=[],c=0,d=this.length;d>c;c++)b=this[c],e.push(a(b));return e}),null==Array.prototype.filter&&(Array.prototype.filter=function(a){var b,c,d,e;for(e=[],c=0,d=this.length;d>c;c++)b=this[c],a(b)&&e.push(b);return e}),null==Array.prototype.reduce&&(Array.prototype.reduce=function(a,b){var c,d,e,f,g;for(e=this.slice(),c=arguments.length<2?e.pop():b,f=0,g=e.length;g>f;f++)d=e[f],c=a(c,d);return c}),null==Array.prototype.forEach&&(Array.prototype.forEach=function(a,b){var c,d,e,f,g;if(!a)throw new Error("No function provided");for(g=[],c=e=0,f=this.length;f>e;c=++e)d=this[c],g.push(a.call(null!=b?b:this,d,c,this));return g}),a||(this.console={log:function(){},error:function(){},
debug:function(){}},"undefined"!=typeof window&&null!==window&&(window.console=this.console)),null==console.log&&(console.log=function(){}),null==console.error&&(console.error=function(){}),null==console.debug&&(console.debug=function(){}),null==console.log.apply)for(console.log("Your console needs patching."),l=["log","error","debug"],i=function(a){var b;return b=console[a],console[a]=function(a){return b(a)}},j=0,k=l.length;k>j;j++)g=l[j],i(g)}).call(this)},{}],13:[function(a,b,c){(function(){var b,d,e,f=function(a,b){return function(){return a.apply(b,arguments)}};d=function(a,b){var c,d,e;e=[];for(c in a)d=a[c],e.push(b[c]=d);return e},b=a("./promise"),e=["attributes","references","collections"],c.Table=function(){function a(a,b){var c,g,h,i,j,k,l;for(this.model=b,this.getDisplayName=f(this.getDisplayName,this),this.name=a.name,this.tags=a.tags,this.displayName=a.displayName,this.attributes=a.attributes,this.references=a.references,this.collections=a.collections,this.fields={},this.__parents__=null!=(k=a["extends"])?k:[],i=0,j=e.length;j>i;i++){if(g=e[i],null==this[g])throw new Error("Bad model data: missing "+g);d(this[g],this.fields)}l=this.collections;for(h in l)c=l[h],c.isCollection=!0}return a.prototype.toString=function(){var a,b;return"[Table name="+this.name+", fields=["+function(){var c,d;c=this.fields,d=[];for(a in c)b=c[a],d.push(a);return d}.call(this)+"]]"},a.prototype.parents=function(){var a;return(null!=(a=this.__parents__)?a:[]).slice()},a.prototype.getDisplayName=function(){return new b(function(a){return function(b,c){return null!=a.model?b(a.model.makePath(a.name).getDisplayName()):c(new Error("model not set - cannot make path"))}}(this))},a}()}).call(this)},{"./promise":8}],14:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j=function(a,b){return function(){return a.apply(b,arguments)}};i=a("./util"),h=i.withCB,f=i.get,g=i.isFunction,b=i.any,e=i.error,d=function(a,b,c,d){return a.service.manageUserPreferences(c,b,d).then(function(b){return a.preferences=b})},c.User=function(){function a(a,b){this.service=a,this.username=b.username,this.preferences=b.preferences,this.refresh=j(this.refresh,this),this.clearPreferences=j(this.clearPreferences,this),this.clearPreference=j(this.clearPreference,this),this.setPreferences=j(this.setPreferences,this),this.setPreference=j(this.setPreference,this),this.hasPreferences=null!=this.preferences,null==this.preferences&&(this.preferences={})}return a.prototype.setPreference=function(a,b,c){var d,f;if(g(b)&&(f=[null,b],b=f[0],c=f[1]),"string"==typeof a)d={},d[a]=b;else{if(null!=b)return h(c,e("Incorrect arguments to setPreference"));d=a}return this.setPreferences(d,c)},a.prototype.setPreferences=function(a,b){return d(this,a,"POST",b)},a.prototype.clearPreference=function(a,b){return d(this,{key:a},"DELETE",b)},a.prototype.clearPreferences=function(a){return d(this,{},"DELETE",a)},a.prototype.refresh=function(a){return d(this,{},"GET",a)},a.prototype.createToken=function(a,c,d){var e,i;return null==a&&(a="day"),null==d&&b([a,c],g)&&(g(a)?(e=[null,null,a],a=e[0],c=e[1],d=e[2]):g(c)&&(i=[null,c],c=i[0],d=i[1])),h(d,this.service.post("user/tokens",{type:a,message:c}).then(f("token")))},a.prototype.fetchCurrentTokens=function(a){return h(a,this.service.get("user/tokens").then(f("tokens")))},a.prototype.revokeAllTokens=function(a){return h(a,this.service.makeRequest("DELETE","user/tokens"))},a.prototype.revokeToken=function(a,b){return h(b,this.service.makeRequest("DELETE","user/tokens/"+a))},a}()}).call(this)},{"./util":15}],15:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=[].slice,x=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},y={}.hasOwnProperty;b=a("./promise"),s=c,s.defer=function(){var a;return a={},a.promise=new b(function(b,c){return a.resolve=b,a.reject=c}),a},g=function(a){return encodeURIComponent(String(a))},r=function(a){var b;return function(){var c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(b.map(g).join("="));return e}().join("&")},s.querystring=function(a){var b,c,d,e,f,g;if(!a)return"";if(o(a))d=a.slice();else{d=[];for(b in a)g=a[b],o(g)?(e=function(){var a,c,d;for(d=[],a=0,c=g.length;c>a;a++)f=g[a],d.push([b,f]);return d}(),d=d.concat(e)):d.push([b,g])}return r(function(){var a,b,e;for(e=[],a=0,b=d.length;b>a;a++)c=d[a],null!=c[1]&&e.push(c);return e}())},s.curry=f=function(){var a,b;return b=arguments[0],a=2<=arguments.length?w.call(arguments,1):[],function(){var c;return c=1<=arguments.length?w.call(arguments,0):[],b.apply(null,a.concat(c))}},s.error=i=function(a){return new b(function(b,c){return c(new Error(a))})},s.success=t=function(a){return new b(function(b,c){return b(a)})},s.parallel=function(){var a;return a=1<=arguments.length?w.call(arguments,0):[],1===a.length&&!a[0].then&&a[0].length?b.all(a[0]):b.all(a)},s.withCB=function(){var a,b,c,d,e,g,h,i;for(b=2<=arguments.length?w.call(arguments,0,g=arguments.length-1):(g=0,[]),e=arguments[g++],h=0,i=b.length;i>h;h++)a=b[h],null!=a&&(d=f(a,null),c=a,e.then(d,c));return e},s.fold=k=function(a){return function(b,c){var d,e,f;if(1===arguments.length&&(c=(null!=b?b.slice():void 0)||b,b=(null!=c?c.shift():void 0)||{}),null==c)throw new Error("xs is null");if(null!=c.reduce)return c.reduce(a,b);e=b;for(d in c)f=c[d],e=null!=e?a(e,d,f):{k:f};return e}},s.take=function(a){return function(b){return null!=a?b.slice(0,+(a-1)+1||9e9):b.slice()}},s.filter=function(a){return function(b){var c,d,e,f;for(f=[],d=0,e=b.length;e>d;d++)c=b[d],a(c)&&f.push(c);return f}},s.uniqBy=function(a,b){var c,d,e,g,h,i;if(1===arguments.length)return f(s.uniqBy,a);if(d=[],e=[],null==b)return e;for(h=0,i=b.length;i>h;h++)g=b[h],c=a(g),x.call(d,c)<0&&(d.push(c),e.push(g));return e},s.find=function(a,b){var c,d,e;if(1===arguments.length)return b=a,function(a){return s.find(a,b)};for(d=0,e=a.length;e>d;d++)if(c=a[d],b(c))return c;return null},o=null!=(v=Array.isArray)?v:function(a){return null!=(null!=a?a.splice:void 0)&&null!=(null!=a?a.push:void 0)&&null!=(null!=a?a.pop:void 0)&&null!=(null!=a?a.slice:void 0)},s.isArray=o,s.isFunction="function"!=typeof/./?function(a){return"function"==typeof a}:function(a){return null!=a&&null!=a.call&&null!=a.apply&&"[object Function]"===a.toString()},h={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},s.escape=function(a){var b,c,d,e,f,g;if(null==a)return"";for(e=String(a).replace(/[&<>"']/g,function(a){return h[a]}),d=[],c=f=0,g=e.length;g>=0?g>=f:f>=g;c=g>=0?++f:--f)b=e.charCodeAt(c),b>256?d.push("&#"+b+";"):d.push(e.charAt(c));return d.join("")},s.omap=function(a){var b;return b=k(function(b,c,d){var e,f,g;return g=a(c,d),e=g[0],f=g[1],o(f)&&(f=f.slice()),b[e]=f,b}),function(a){return b({},a)}},s.copy=s.omap(function(a,b){return[a,b]}),s.partition=function(a){return function(b){var c;return(c=k(function(b,c){var d,e;return e=b[0],d=b[1],a(c)?[e.concat([c]),d]:[e,d.concat([c])]}))([[],[]],b)}},s.merge=function(a,b){return extend(extend({},a),b)},s.extend=function(a,b){var c,d,e;e=[];for(c in b)d=b[c],e.push(a[c]=d);return e},s.id=l=function(a){return a},s.concatMap=function(a){return function(b){var c,d,e,f,g;for(d=void 0,f=0,g=b.length;g>f;f++)e=b[f],c=a(e),d=void 0===d?c:"number"==typeof d?d+c:null!=d.concat?d.concat(c):p(d,c);return d}},s.map=function(a){return m("map",a)},e=k(function(a,b){return function(){var c;return c=1<=arguments.length?w.call(arguments,0):[],a(b.apply(null,c))}}),s.compose=function(){var a;return a=1<=arguments.length?w.call(arguments,0):[],e(a)},s.flatMap=s.concatMap,s.difference=function(a,b){var c,d,e,f;for(f=[],d=0,e=a.length;e>d;d++)c=a[d],x.call(b,c)<0&&f.push(c);return f},s.stringList=function(a){return"string"==typeof a?[a]:a},s.flatten=j=function(){var a,b,c,d,e,f,g,h,i;for(c=1<=arguments.length?w.call(arguments,0):[],a=[],e=0,g=c.length;g>e;e++)if(b=c[e],o(b))for(i=j.apply(null,b),f=0,h=i.length;h>f;f++)d=i[f],a.push(d);else a.push(b);return a},s.sum=s.concatMap(l),s.merge=p=function(){var a,b,c,d,e,f,g;for(d=1<=arguments.length?w.call(arguments,0):[],b={},f=0,g=d.length;g>f;f++){c=d[f];for(a in c)y.call(c,a)&&(e=c[a],b[a]=e)}return b},s.any=function(a,b){var c,d,e;for(null==b&&(b=l),d=0,e=a.length;e>d;d++)if(c=a[d],b(c))return!0;return!1},s.invoke=m=function(){var a,b;return b=arguments[0],a=2<=arguments.length?w.call(arguments,1):[],n(b,a)},s.invokeWith=n=function(a,b,c){return null==b&&(b=[]),null==c&&(c=null),function(d){if(null==d)throw new Error('Cannot call method "'+a+'" of null');if(d[a])return d[a].apply(c||d,b);throw new Error('Cannot call undefined method "'+a+" of "+d)}},s.get=function(a){return function(b){return b[a]}},s.set=function(a,b){return function(c){var d,e;if(2===arguments.length)c[a]=b;else for(d in a)y.call(a,d)&&(e=a[d],c[d]=e);return c}},d=function(a,b){return"This service requires a service at version "+a+" or above. This one is at "+b},s.REQUIRES_VERSION=function(a,b,c){return a.fetchVersion().then(function(a){return a>=b?c():i(d(b,a))})},s.dejoin=function(a){var b,c,d,e,f;for(f=a.views,d=0,e=f.length;e>d;d++)c=f[d],b=c.split("."),b.length>2&&a.addJoin(b.slice(1,-1).join("."));return a},u=k(function(a,b){return a.then(b)}),s.sequence=function(){var a;return a=1<=arguments.length?w.call(arguments,0):[],u(t(),a)},q=k(function(a,b){var c,d;if(c=b[0],d=b[1],null!=a[c])throw new Error("Duplicate key: "+c);return a[c]=d,a}),s.pairsToObj=function(a){return q({},a)}}).call(this)},{"./promise":8}],16:[function(a,b,c){(function(){c.VERSION="3.15.0"}).call(this)},{}],17:[function(a,b,c){(function(){var b,d;b=a("xmldom").DOMParser,d=function(a){return a=a.replace(/^\s*/g,""),a=a.replace(/\s$/g,""),0===a.length?a:">"!==a[a.length-1]?a+">":a},c.parse=function(a){var c,e;if("string"!=typeof a)throw new Error("Expected a string - got "+a);if(a=d(a),!a)throw new Error("Expected content - got empty string");if(c=function(){try{return e=new b,e.parseFromString(a,"text/xml")}catch(c){}}(),!c||!c.documentElement||c.getElementsByTagName("parsererror").length)throw new Error("Invalid XML: "+a);return c}}).call(this)},{xmldom:11}],18:[function(a,b,c){(function(d,e){function f(a,b){return"string"==typeof a?b==a:a&&"function"==typeof a.exec?a.exec(b):"boolean"==typeof a?a:"function"==typeof a?a(b):!1}var g=a("jsonparse"),h=a("through");c.parse=function(a,b){var c=new g,d=h(function(a){"string"==typeof a&&(a=new e(a)),c.write(a)},function(a){a&&d.write(a),d.queue(null)});"string"==typeof a&&(a=a.split(".").map(function(a){return"*"===a?!0:""===a?{recurse:!0}:a}));var i=0;return a&&a.length||(a=null),c.onValue=function(c){if(this.root||(d.root=c),a){for(var e=0,g=0;e<a.length;){var h,j=a[e];if(g++,j&&!j.recurse){if(h=g===this.stack.length?this:this.stack[g],!h)return;if(!f(j,h.key))return;e++}else{e++;var k=a[e];if(!k)return;for(;;){if(h=g===this.stack.length?this:this.stack[g],!h)return;if(f(k,h.key)){e++;break}g++}}}if(g===this.stack.length){i++;var l=this.stack.slice(1).map(function(a){return a.key}).concat([this.key]),m=this.value[this.key];null!=m&&null!=(m=b?b(m,l):m)&&d.queue(m),delete this.value[this.key]}}},c._onToken=c.onToken,c.onToken=function(b,e){c._onToken(b,e),0===this.stack.length&&d.root&&(a||d.queue(d.root),d.emit("root",d.root,i),i=0,d.root=null)},c.onError=function(a){d.emit("error",a)},d},c.stringify=function(a,b,c,d){d=d||0,a===!1?(a="",b="\n",c=""):null==a&&(a="[\n",b="\n,\n",c="\n]\n");var e,f=!0,g=!1;return e=h(function(c){g=!0;var h=JSON.stringify(c,null,d);f?(f=!1,e.queue(a+h)):e.queue(b+h)},function(b){g||e.queue(a),e.queue(c),e.queue(null)})},c.stringifyObject=function(a,b,c,d){d=d||0,a===!1?(a="",b="\n",c=""):null==a&&(a="{\n",b="\n,\n",c="\n}\n");var e=!0,f=!1;return stream=h(function(c){f=!0;var g=JSON.stringify(c[0])+":"+JSON.stringify(c[1],null,d);e?(e=!1,this.queue(a+g)):this.queue(b+g)},function(b){f||this.queue(a),this.queue(c),this.queue(null)}),stream},b.parent||"browser"===d.title||d.stdin.pipe(c.parse(d.argv[2])).pipe(c.stringify("[",",\n","]\n",2)).pipe(d.stdout)}).call(this,a("/home/josh/src/imjs/node_modules/insert-module-globals/node_modules/process/browser.js"),a("buffer").Buffer)},{"/home/josh/src/imjs/node_modules/insert-module-globals/node_modules/process/browser.js":57,buffer:25,jsonparse:19,through:20}],19:[function(a,b,c){(function(a){function c(a){for(var b=Object.keys(e),c=0,d=b.length;d>c;c++){var f=b[c];if(e[f]===a)return f}return a&&"0x"+a.toString(16)}function d(){this.tState=q,this.value=void 0,this.string=void 0,this.unicode=void 0,this.negative=void 0,this.magnatude=void 0,this.position=void 0,this.exponent=void 0,this.negativeExponent=void 0,this.key=void 0,this.mode=void 0,this.stack=[],this.state=P,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new a(2),3:new a(3),4:new a(4)}}var e={},f=e.LEFT_BRACE=1,g=e.RIGHT_BRACE=2,h=e.LEFT_BRACKET=3,i=e.RIGHT_BRACKET=4,j=e.COLON=5,k=e.COMMA=6,l=e.TRUE=7,m=e.FALSE=8,n=e.NULL=9,o=e.STRING=10,p=e.NUMBER=11,q=e.START=17,r=e.TRUE1=33,s=e.TRUE2=34,t=e.TRUE3=35,u=e.FALSE1=49,v=e.FALSE2=50,w=e.FALSE3=51,x=e.FALSE4=52,y=e.NULL1=65,z=e.NULL3=66,A=e.NULL2=67,B=e.NUMBER1=81,C=e.NUMBER2=82,D=e.NUMBER3=83,E=e.NUMBER4=84,F=e.NUMBER5=85,G=e.NUMBER6=86,H=e.NUMBER7=87,I=e.NUMBER8=88,J=e.STRING1=97,K=e.STRING2=98,L=e.STRING3=99,M=e.STRING4=100,N=e.STRING5=101,O=e.STRING6=102,P=e.VALUE=113,Q=e.KEY=114,R=e.OBJECT=129,S=e.ARRAY=130,T=d.prototype;T.charError=function(a,b){this.onError(new Error("Unexpected "+JSON.stringify(String.fromCharCode(a[b]))+" at position "+b+" in state "+c(this.tState)))},T.onError=function(a){throw a},T.write=function(b){"string"==typeof b&&(b=new a(b));for(var c,d=0,e=b.length;e>d;d++)if(this.tState===q)c=b[d],123===c?this.onToken(f,"{"):125===c?this.onToken(g,"}"):91===c?this.onToken(h,"["):93===c?this.onToken(i,"]"):58===c?this.onToken(j,":"):44===c?this.onToken(k,","):116===c?this.tState=r:102===c?this.tState=u:110===c?this.tState=y:34===c?(this.string="",this.tState=J):45===c?(this.negative=!0,this.tState=B):48===c?(this.magnatude=0,this.tState=C):c>48&&64>c?(this.magnatude=c-48,this.tState=D):32===c||9===c||10===c||13===c||this.charError(b,d);else if(this.tState===J)if(c=b[d],this.bytes_remaining>0){for(var P=0;P<this.bytes_remaining;P++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+P]=b[P];this.string+=this.temp_buffs[this.bytes_in_sequence].toString(),this.bytes_in_sequence=this.bytes_remaining=0,d=d+P-1}else if(0===this.bytes_remaining&&c>=128)if(c>=194&&223>=c&&(this.bytes_in_sequence=2),c>=224&&239>=c&&(this.bytes_in_sequence=3),c>=240&&244>=c&&(this.bytes_in_sequence=4),this.bytes_in_sequence+d>b.length){for(var Q=0;Q<=b.length-1-d;Q++)this.temp_buffs[this.bytes_in_sequence][Q]=b[d+Q];this.bytes_remaining=d+this.bytes_in_sequence-b.length,d=b.length-1}else this.string+=b.slice(d,d+this.bytes_in_sequence).toString(),d=d+this.bytes_in_sequence-1;else 34===c?(this.tState=q,this.onToken(o,this.string),this.string=void 0):92===c?this.tState=K:c>=32?this.string+=String.fromCharCode(c):this.charError(b,d);else this.tState===K?(c=b[d],34===c?(this.string+='"',this.tState=J):92===c?(this.string+="\\",this.tState=J):47===c?(this.string+="/",this.tState=J):98===c?(this.string+="\b",this.tState=J):102===c?(this.string+="\f",this.tState=J):110===c?(this.string+="\n",this.tState=J):114===c?(this.string+="\r",this.tState=J):116===c?(this.string+="	",this.tState=J):117===c?(this.unicode="",this.tState=L):this.charError(b,d)):this.tState===L||this.tState===M||this.tState===N||this.tState===O?(c=b[d],c>=48&&64>c||c>64&&70>=c||c>96&&102>=c?(this.unicode+=String.fromCharCode(c),this.tState++===O&&(this.string+=String.fromCharCode(parseInt(this.unicode,16)),this.unicode=void 0,this.tState=J)):this.charError(b,d)):this.tState===B?(c=b[d],48===c?(this.magnatude=0,this.tState=C):c>48&&64>c?(this.magnatude=c-48,this.tState=D):this.charError(b,d)):this.tState===C?(c=b[d],46===c?(this.position=.1,this.tState=E):101===c||69===c?(this.exponent=0,this.tState=G):(this.tState=q,this.onToken(p,0),this.magnatude=void 0,this.negative=void 0,d--)):this.tState===D?(c=b[d],46===c?(this.position=.1,this.tState=E):101===c||69===c?(this.exponent=0,this.tState=G):c>=48&&64>c?this.magnatude=10*this.magnatude+c-48:(this.tState=q,this.negative&&(this.magnatude=-this.magnatude,this.negative=void 0),this.onToken(p,this.magnatude),this.magnatude=void 0,d--)):this.tState===E?(c=b[d],c>=48&&64>c?(this.magnatude+=this.position*(c-48),this.position/=10,this.tState=F):this.charError(b,d)):this.tState===F?(c=b[d],c>=48&&64>c?(this.magnatude+=this.position*(c-48),this.position/=10):101===c||69===c?(this.exponent=0,this.tState=G):(this.tState=q,this.negative&&(this.magnatude=-this.magnatude,this.negative=void 0),this.onToken(p,this.negative?-this.magnatude:this.magnatude),this.magnatude=void 0,this.position=void 0,d--)):this.tState===G?(c=b[d],43===c||45===c?(45===c&&(this.negativeExponent=!0),this.tState=H):c>=48&&64>c?(this.exponent=10*this.exponent+(c-48),this.tState=I):this.charError(b,d)):this.tState===H?(c=b[d],c>=48&&64>c?(this.exponent=10*this.exponent+(c-48),this.tState=I):this.charError(b,d)):this.tState===I?(c=b[d],c>=48&&64>c?this.exponent=10*this.exponent+(c-48):(this.negativeExponent&&(this.exponent=-this.exponent,this.negativeExponent=void 0),this.magnatude*=Math.pow(10,this.exponent),this.exponent=void 0,this.negative&&(this.magnatude=-this.magnatude,this.negative=void 0),this.tState=q,this.onToken(p,this.magnatude),this.magnatude=void 0,d--)):this.tState===r?114===b[d]?this.tState=s:this.charError(b,d):this.tState===s?117===b[d]?this.tState=t:this.charError(b,d):this.tState===t?101===b[d]?(this.tState=q,this.onToken(l,!0)):this.charError(b,d):this.tState===u?97===b[d]?this.tState=v:this.charError(b,d):this.tState===v?108===b[d]?this.tState=w:this.charError(b,d):this.tState===w?115===b[d]?this.tState=x:this.charError(b,d):this.tState===x?101===b[d]?(this.tState=q,this.onToken(m,!1)):this.charError(b,d):this.tState===y?117===b[d]?this.tState=z:this.charError(b,d):this.tState===z?108===b[d]?this.tState=A:this.charError(b,d):this.tState===A&&(108===b[d]?(this.tState=q,this.onToken(n,null)):this.charError(b,d))},T.onToken=function(a,b){},T.parseError=function(a,b){this.onError(new Error("Unexpected "+c(a)+(b?"("+JSON.stringify(b)+")":"")+" in state "+c(this.state)))},T.onError=function(a){throw a},T.push=function(){this.stack.push({value:this.value,key:this.key,mode:this.mode})},T.pop=function(){var a=this.value,b=this.stack.pop();this.value=b.value,this.key=b.key,this.mode=b.mode,this.emit(a),this.mode||(this.state=P)},T.emit=function(a){this.mode&&(this.state=k),this.onValue(a)},T.onValue=function(a){},T.onToken=function(a,b){this.state===P?a===o||a===p||a===l||a===m||a===n?(this.value&&(this.value[this.key]=b),this.emit(b)):a===f?(this.push(),this.value?this.value=this.value[this.key]={}:this.value={},this.key=void 0,this.state=Q,this.mode=R):a===h?(this.push(),this.value?this.value=this.value[this.key]=[]:this.value=[],this.key=0,this.mode=S,this.state=P):a===g?this.mode===R?this.pop():this.parseError(a,b):a===i&&this.mode===S?this.pop():this.parseError(a,b):this.state===Q?a===o?(this.key=b,this.state=j):a===g?this.pop():this.parseError(a,b):this.state===j?a===j?this.state=P:this.parseError(a,b):this.state===k?a===k?this.mode===S?(this.key++,this.state=P):this.mode===R&&(this.state=Q):a===i&&this.mode===S||a===g&&this.mode===R?this.pop():this.parseError(a,b):this.parseError(a,b)},b.exports=d}).call(this,a("buffer").Buffer)},{buffer:25}],20:[function(a,b,c){(function(d){function e(a,b,c){function e(){for(;j.length&&!l.paused;){var a=j.shift();if(null===a)return l.emit("end");l.emit("data",a)}}function g(){l.writable=!1,b.call(l),!l.readable&&l.autoDestroy&&l.destroy()}a=a||function(a){this.queue(a)},b=b||function(){this.queue(null)};var h=!1,i=!1,j=[],k=!1,l=new f;return l.readable=l.writable=!0,l.paused=!1,l.autoDestroy=!(c&&c.autoDestroy===!1),l.write=function(b){return a.call(this,b),!l.paused},l.queue=l.push=function(a){return k?l:(null===a&&(k=!0),j.push(a),e(),l)},l.on("end",function(){l.readable=!1,!l.writable&&l.autoDestroy&&d.nextTick(function(){l.destroy()})}),l.end=function(a){return h?void 0:(h=!0,arguments.length&&l.write(a),g(),l)},l.destroy=function(){return i?void 0:(i=!0,h=!0,j.length=0,l.writable=l.readable=!1,l.emit("close"),l)},l.pause=function(){return l.paused?void 0:(l.paused=!0,l)},l.resume=function(){return l.paused&&(l.paused=!1,l.emit("resume")),e(),l.paused||l.emit("drain"),l},l}var f=a("stream");c=b.exports=e,e.through=e}).call(this,a("/home/josh/src/imjs/node_modules/insert-module-globals/node_modules/process/browser.js"))},{"/home/josh/src/imjs/node_modules/insert-module-globals/node_modules/process/browser.js":57,stream:47}],21:[function(a,c,d){!function(){function a(){return{keys:Object.keys||function(a){if("object"!=typeof a&&"function"!=typeof a||null===a)throw new TypeError("keys() called on a non-object");var b,c=[];for(b in a)a.hasOwnProperty(b)&&(c[c.length]=b);return c},uniqueId:function(a){var b=++j+"";return a?a+b:b},has:function(a,b){return h.call(a,b)},each:function(a,b,c){if(null!=a)if(g&&a.forEach===g)a.forEach(b,c);else if(a.length===+a.length)for(var d=0,e=a.length;e>d;d++)b.call(c,a[d],d,a);else for(var f in a)this.has(a,f)&&b.call(c,a[f],f,a)},once:function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}}}}var e,f=this,g=Array.prototype.forEach,h=Object.prototype.hasOwnProperty,i=Array.prototype.slice,j=0,k=a();e={on:function(a,b,c){if(!m(this,"on",a,[b,c])||!b)return this;this._events||(this._events={});var d=this._events[a]||(this._events[a]=[]);return d.push({callback:b,context:c,ctx:c||this}),this},once:function(a,b,c){if(!m(this,"once",a,[b,c])||!b)return this;var d=this,e=k.once(function(){d.off(a,e),b.apply(this,arguments)});return e._callback=b,this.on(a,e,c)},off:function(a,b,c){var d,e,f,g,h,i,j,l;if(!this._events||!m(this,"off",a,[b,c]))return this;if(!a&&!b&&!c)return this._events={},this;for(g=a?[a]:k.keys(this._events),h=0,i=g.length;i>h;h++)if(a=g[h],f=this._events[a]){if(this._events[a]=d=[],b||c)for(j=0,l=f.length;l>j;j++)e=f[j],(b&&b!==e.callback&&b!==e.callback._callback||c&&c!==e.context)&&d.push(e);d.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=i.call(arguments,1);if(!m(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;return c&&n(c,b),d&&n(d,arguments),this},stopListening:function(a,b,c){var d=this._listeners;if(!d)return this;var e=!b&&!c;"object"==typeof b&&(c=this),a&&((d={})[a._listenerId]=a);for(var f in d)d[f].off(b,c,this),e&&delete this._listeners[f];return this}};var l=/\s+/,m=function(a,b,c,d){if(!c)return!0;if("object"==typeof c){for(var e in c)a[b].apply(a,[e,c[e]].concat(d));return!1}if(l.test(c)){for(var f=c.split(l),g=0,h=f.length;h>g;g++)a[b].apply(a,[f[g]].concat(d));return!1}return!0},n=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b)}},o={listenTo:"on",listenToOnce:"once"};k.each(o,function(a,b){e[b]=function(b,c,d){var e=this._listeners||(this._listeners={}),f=b._listenerId||(b._listenerId=k.uniqueId("l"));return e[f]=b,"object"==typeof c&&(d=this),b[a](c,d,this),this}}),e.bind=e.on,e.unbind=e.off,e.mixin=function(a){var b=["on","once","off","trigger","stopListening","listenTo","listenToOnce","bind","unbind"];return k.each(b,function(b){a[b]=this[b]},this),a},"undefined"!=typeof d?("undefined"!=typeof c&&c.exports&&(d=c.exports=e),d.BackboneEvents=e):"function"==typeof b&&"object"==typeof b.amd?b(function(){return e}):f.BackboneEvents=e}(this)},{}],22:[function(a,b,c){b.exports=a("./backbone-events-standalone")},{"./backbone-events-standalone":21}],23:[function(a,c,d){(function(d,e){(function(){"use strict";function f(a){return"function"==typeof a||"object"==typeof a&&null!==a}function g(a){return"function"==typeof a}function h(a){return"object"==typeof a&&null!==a}function i(a){U=a}function j(a){Y=a}function k(){var a=d.nextTick,b=d.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(b)&&"0"===b[1]&&"10"===b[2]&&(a=setImmediate),function(){a(p)}}function l(){return function(){T(p)}}function m(){var a=0,b=new _(p),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function n(){var a=new MessageChannel;return a.port1.onmessage=p,function(){a.port2.postMessage(0)}}function o(){return function(){setTimeout(p,1)}}function p(){for(var a=0;X>a;a+=2){var b=ca[a],c=ca[a+1];b(c),ca[a]=void 0,ca[a+1]=void 0}X=0}function q(){try{var b=a,c=b("vertx");return T=c.runOnLoop||c.runOnContext,l()}catch(d){return o()}}function r(){}function s(){return new TypeError("You cannot resolve a promise with itself")}function t(){return new TypeError("A promises callback cannot return that same promise.")}function u(a){try{return a.then}catch(b){return ga.error=b,ga}}function v(a,b,c,d){try{a.call(b,c,d)}catch(e){return e}}function w(a,b,c){Y(function(a){var d=!1,e=v(c,b,function(c){d||(d=!0,b!==c?z(a,c):B(a,c))},function(b){d||(d=!0,C(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&e&&(d=!0,C(a,e))},a)}function x(a,b){b._state===ea?B(a,b._result):b._state===fa?C(a,b._result):D(b,void 0,function(b){z(a,b)},function(b){C(a,b)})}function y(a,b){if(b.constructor===a.constructor)x(a,b);else{var c=u(b);c===ga?C(a,ga.error):void 0===c?B(a,b):g(c)?w(a,b,c):B(a,b)}}function z(a,b){a===b?C(a,s()):f(b)?y(a,b):B(a,b)}function A(a){a._onerror&&a._onerror(a._result),E(a)}function B(a,b){a._state===da&&(a._result=b,a._state=ea,0!==a._subscribers.length&&Y(E,a))}function C(a,b){a._state===da&&(a._state=fa,a._result=b,Y(A,a))}function D(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null,e[f]=b,e[f+ea]=c,e[f+fa]=d,0===f&&a._state&&Y(E,a)}function E(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d,e,f=a._result,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?H(c,d,e,f):e(f);a._subscribers.length=0}}function F(){this.error=null}function G(a,b){try{return a(b)}catch(c){return ha.error=c,ha}}function H(a,b,c,d){var e,f,h,i,j=g(c);if(j){if(e=G(c,d),e===ha?(i=!0,f=e.error,e=null):h=!0,b===e)return void C(b,t())}else e=d,h=!0;b._state!==da||(j&&h?z(b,e):i?C(b,f):a===ea?B(b,e):a===fa&&C(b,e))}function I(a,b){try{b(function(b){z(a,b)},function(b){C(a,b)})}catch(c){C(a,c)}}function J(a,b){var c=this;c._instanceConstructor=a,c.promise=new a(r),c._validateInput(b)?(c._input=b,c.length=b.length,c._remaining=b.length,c._init(),0===c.length?B(c.promise,c._result):(c.length=c.length||0,c._enumerate(),0===c._remaining&&B(c.promise,c._result))):C(c.promise,c._validationError())}function K(a){return new ia(this,a).promise}function L(a){function b(a){z(e,a)}function c(a){C(e,a)}var d=this,e=new d(r);if(!W(a))return C(e,new TypeError("You must pass an array to race.")),e;for(var f=a.length,g=0;e._state===da&&f>g;g++)D(d.resolve(a[g]),void 0,b,c);return e}function M(a){var b=this;if(a&&"object"==typeof a&&a.constructor===b)return a;var c=new b(r);return z(c,a),c}function N(a){var b=this,c=new b(r);return C(c,a),c}function O(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function P(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function Q(a){this._id=na++,this._state=void 0,this._result=void 0,this._subscribers=[],r!==a&&(g(a)||O(),this instanceof Q||P(),I(this,a))}function R(){var a;if("undefined"!=typeof e)a=e;else if("undefined"!=typeof self)a=self;else try{a=Function("return this")()}catch(b){throw new Error("polyfill failed because global object is unavailable in this environment")}var c=a.Promise;(!c||"[object Promise]"!==Object.prototype.toString.call(c.resolve())||c.cast)&&(a.Promise=oa)}var S;S=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)};var T,U,V,W=S,X=0,Y=({}.toString,function(a,b){ca[X]=a,ca[X+1]=b,X+=2,2===X&&(U?U(p):V())}),Z="undefined"!=typeof window?window:void 0,$=Z||{},_=$.MutationObserver||$.WebKitMutationObserver,aa="undefined"!=typeof d&&"[object process]"==={}.toString.call(d),ba="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ca=new Array(1e3);V=aa?k():_?m():ba?n():void 0===Z&&"function"==typeof a?q():o();var da=void 0,ea=1,fa=2,ga=new F,ha=new F;J.prototype._validateInput=function(a){return W(a)},J.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},J.prototype._init=function(){this._result=new Array(this.length)};var ia=J;J.prototype._enumerate=function(){for(var a=this,b=a.length,c=a.promise,d=a._input,e=0;c._state===da&&b>e;e++)a._eachEntry(d[e],e)},J.prototype._eachEntry=function(a,b){var c=this,d=c._instanceConstructor;h(a)?a.constructor===d&&a._state!==da?(a._onerror=null,c._settledAt(a._state,b,a._result)):c._willSettleAt(d.resolve(a),b):(c._remaining--,c._result[b]=a)},J.prototype._settledAt=function(a,b,c){var d=this,e=d.promise;e._state===da&&(d._remaining--,a===fa?C(e,c):d._result[b]=c),0===d._remaining&&B(e,d._result)},J.prototype._willSettleAt=function(a,b){var c=this;D(a,void 0,function(a){c._settledAt(ea,b,a)},function(a){c._settledAt(fa,b,a)})};var ja=K,ka=L,la=M,ma=N,na=0,oa=Q;Q.all=ja,Q.race=ka,Q.resolve=la,Q.reject=ma,Q._setScheduler=i,Q._setAsap=j,Q._asap=Y,Q.prototype={constructor:Q,then:function(a,b){var c=this,d=c._state;if(d===ea&&!a||d===fa&&!b)return this;var e=new this.constructor(r),f=c._result;if(d){var g=arguments[d-1];Y(function(){H(d,e,g,f)})}else D(c,e,a,b);return e},"catch":function(a){return this.then(null,a)}};var pa=R,qa={Promise:oa,polyfill:pa};"function"==typeof b&&b.amd?b(function(){return qa}):"undefined"!=typeof c&&c.exports?c.exports=qa:"undefined"!=typeof this&&(this.ES6Promise=qa),pa()}).call(this)}).call(this,a("/home/josh/src/imjs/node_modules/insert-module-globals/node_modules/process/browser.js"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"/home/josh/src/imjs/node_modules/insert-module-globals/node_modules/process/browser.js":57}],24:[function(a,b,c){},{}],25:[function(a,b,c){function d(a,b,c){if(!(this instanceof d))return new d(a,b,c);var e,f=typeof a;if("number"===f)e=a>0?a>>>0:0;else if("string"===f)"base64"===b&&(a=x(a)),e=d.byteLength(a,b);else{if("object"!==f||null===a)throw new TypeError("must start with number, buffer, array or string");"Buffer"===a.type&&J(a.data)&&(a=a.data),e=+a.length>0?Math.floor(+a.length):0}if(this.length>K)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+K.toString(16)+" bytes");var g;d.TYPED_ARRAY_SUPPORT?g=d._augment(new Uint8Array(e)):(g=this,g.length=e,g._isBuffer=!0);var h;if(d.TYPED_ARRAY_SUPPORT&&"number"==typeof a.byteLength)g._set(a);else if(z(a))if(d.isBuffer(a))for(h=0;e>h;h++)g[h]=a.readUInt8(h);else for(h=0;e>h;h++)g[h]=(a[h]%256+256)%256;else if("string"===f)g.write(a,0,b);else if("number"===f&&!d.TYPED_ARRAY_SUPPORT&&!c)for(h=0;e>h;h++)g[h]=0;return g}function e(a,b,c,d){c=Number(c)||0;var e=a.length-c;d?(d=Number(d),d>e&&(d=e)):d=e;var f=b.length;if(f%2!==0)throw new Error("Invalid hex string");d>f/2&&(d=f/2);for(var g=0;d>g;g++){var h=parseInt(b.substr(2*g,2),16);if(isNaN(h))throw new Error("Invalid hex string");a[c+g]=h}return g}function f(a,b,c,d){var e=F(B(b),a,c,d);return e}function g(a,b,c,d){var e=F(C(b),a,c,d);return e}function h(a,b,c,d){return g(a,b,c,d)}function i(a,b,c,d){var e=F(E(b),a,c,d);return e}function j(a,b,c,d){var e=F(D(b),a,c,d,2);return e}function k(a,b,c){return 0===b&&c===a.length?H.fromByteArray(a):H.fromByteArray(a.slice(b,c));
}function l(a,b,c){var d="",e="";c=Math.min(a.length,c);for(var f=b;c>f;f++)a[f]<=127?(d+=G(e)+String.fromCharCode(a[f]),e=""):e+="%"+a[f].toString(16);return d+G(e)}function m(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;e++)d+=String.fromCharCode(a[e]);return d}function n(a,b,c){return m(a,b,c)}function o(a,b,c){var d=a.length;(!b||0>b)&&(b=0),(!c||0>c||c>d)&&(c=d);for(var e="",f=b;c>f;f++)e+=A(a[f]);return e}function p(a,b,c){for(var d=a.slice(b,c),e="",f=0;f<d.length;f+=2)e+=String.fromCharCode(d[f]+256*d[f+1]);return e}function q(a,b,c){if(a%1!==0||0>a)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length")}function r(a,b,c,e,f,g){if(!d.isBuffer(a))throw new TypeError("buffer must be a Buffer instance");if(b>f||g>b)throw new TypeError("value is out of bounds");if(c+e>a.length)throw new TypeError("index out of range")}function s(a,b,c,d){0>b&&(b=65535+b+1);for(var e=0,f=Math.min(a.length-c,2);f>e;e++)a[c+e]=(b&255<<8*(d?e:1-e))>>>8*(d?e:1-e)}function t(a,b,c,d){0>b&&(b=4294967295+b+1);for(var e=0,f=Math.min(a.length-c,4);f>e;e++)a[c+e]=b>>>8*(d?e:3-e)&255}function u(a,b,c,d,e,f){if(b>e||f>b)throw new TypeError("value is out of bounds");if(c+d>a.length)throw new TypeError("index out of range")}function v(a,b,c,d,e){return e||u(a,b,c,4,3.4028234663852886e38,-3.4028234663852886e38),I.write(a,b,c,d,23,4),c+4}function w(a,b,c,d,e){return e||u(a,b,c,8,1.7976931348623157e308,-1.7976931348623157e308),I.write(a,b,c,d,52,8),c+8}function x(a){for(a=y(a).replace(M,"");a.length%4!==0;)a+="=";return a}function y(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function z(a){return J(a)||d.isBuffer(a)||a&&"object"==typeof a&&"number"==typeof a.length}function A(a){return 16>a?"0"+a.toString(16):a.toString(16)}function B(a){for(var b=[],c=0;c<a.length;c++){var d=a.charCodeAt(c);if(127>=d)b.push(d);else{var e=c;d>=55296&&57343>=d&&c++;for(var f=encodeURIComponent(a.slice(e,c+1)).substr(1).split("%"),g=0;g<f.length;g++)b.push(parseInt(f[g],16))}}return b}function C(a){for(var b=[],c=0;c<a.length;c++)b.push(255&a.charCodeAt(c));return b}function D(a){for(var b,c,d,e=[],f=0;f<a.length;f++)b=a.charCodeAt(f),c=b>>8,d=b%256,e.push(d),e.push(c);return e}function E(a){return H.toByteArray(a)}function F(a,b,c,d,e){e&&(d-=d%e);for(var f=0;d>f&&!(f+c>=b.length||f>=a.length);f++)b[f+c]=a[f];return f}function G(a){try{return decodeURIComponent(a)}catch(b){return String.fromCharCode(65533)}}var H=a("base64-js"),I=a("ieee754"),J=a("is-array");c.Buffer=d,c.SlowBuffer=d,c.INSPECT_MAX_BYTES=50,d.poolSize=8192;var K=1073741823;d.TYPED_ARRAY_SUPPORT=function(){try{var a=new ArrayBuffer(0),b=new Uint8Array(a);return b.foo=function(){return 42},42===b.foo()&&"function"==typeof b.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(c){return!1}}(),d.isBuffer=function(a){return!(null==a||!a._isBuffer)},d.compare=function(a,b){if(!d.isBuffer(a)||!d.isBuffer(b))throw new TypeError("Arguments must be Buffers");for(var c=a.length,e=b.length,f=0,g=Math.min(c,e);g>f&&a[f]===b[f];f++);return f!==g&&(c=a[f],e=b[f]),e>c?-1:c>e?1:0},d.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(a,b){if(!J(a))throw new TypeError("Usage: Buffer.concat(list[, length])");if(0===a.length)return new d(0);if(1===a.length)return a[0];var c;if(void 0===b)for(b=0,c=0;c<a.length;c++)b+=a[c].length;var e=new d(b),f=0;for(c=0;c<a.length;c++){var g=a[c];g.copy(e,f),f+=g.length}return e},d.byteLength=function(a,b){var c;switch(a+="",b||"utf8"){case"ascii":case"binary":case"raw":c=a.length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":c=2*a.length;break;case"hex":c=a.length>>>1;break;case"utf8":case"utf-8":c=B(a).length;break;case"base64":c=E(a).length;break;default:c=a.length}return c},d.prototype.length=void 0,d.prototype.parent=void 0,d.prototype.toString=function(a,b,c){var d=!1;if(b>>>=0,c=void 0===c||c===1/0?this.length:c>>>0,a||(a="utf8"),0>b&&(b=0),c>this.length&&(c=this.length),b>=c)return"";for(;;)switch(a){case"hex":return o(this,b,c);case"utf8":case"utf-8":return l(this,b,c);case"ascii":return m(this,b,c);case"binary":return n(this,b,c);case"base64":return k(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return p(this,b,c);default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}},d.prototype.equals=function(a){if(!d.isBuffer(a))throw new TypeError("Argument must be a Buffer");return 0===d.compare(this,a)},d.prototype.inspect=function(){var a="",b=c.INSPECT_MAX_BYTES;return this.length>0&&(a=this.toString("hex",0,b).match(/.{2}/g).join(" "),this.length>b&&(a+=" ... ")),"<Buffer "+a+">"},d.prototype.compare=function(a){if(!d.isBuffer(a))throw new TypeError("Argument must be a Buffer");return d.compare(this,a)},d.prototype.get=function(a){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(a)},d.prototype.set=function(a,b){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(a,b)},d.prototype.write=function(a,b,c,d){if(isFinite(b))isFinite(c)||(d=c,c=void 0);else{var k=d;d=b,b=c,c=k}b=Number(b)||0;var l=this.length-b;c?(c=Number(c),c>l&&(c=l)):c=l,d=String(d||"utf8").toLowerCase();var m;switch(d){case"hex":m=e(this,a,b,c);break;case"utf8":case"utf-8":m=f(this,a,b,c);break;case"ascii":m=g(this,a,b,c);break;case"binary":m=h(this,a,b,c);break;case"base64":m=i(this,a,b,c);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":m=j(this,a,b,c);break;default:throw new TypeError("Unknown encoding: "+d)}return m},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},d.prototype.slice=function(a,b){var c=this.length;if(a=~~a,b=void 0===b?c:~~b,0>a?(a+=c,0>a&&(a=0)):a>c&&(a=c),0>b?(b+=c,0>b&&(b=0)):b>c&&(b=c),a>b&&(b=a),d.TYPED_ARRAY_SUPPORT)return d._augment(this.subarray(a,b));for(var e=b-a,f=new d(e,void 0,!0),g=0;e>g;g++)f[g]=this[g+a];return f},d.prototype.readUInt8=function(a,b){return b||q(a,1,this.length),this[a]},d.prototype.readUInt16LE=function(a,b){return b||q(a,2,this.length),this[a]|this[a+1]<<8},d.prototype.readUInt16BE=function(a,b){return b||q(a,2,this.length),this[a]<<8|this[a+1]},d.prototype.readUInt32LE=function(a,b){return b||q(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},d.prototype.readUInt32BE=function(a,b){return b||q(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},d.prototype.readInt8=function(a,b){return b||q(a,1,this.length),128&this[a]?-1*(255-this[a]+1):this[a]},d.prototype.readInt16LE=function(a,b){b||q(a,2,this.length);var c=this[a]|this[a+1]<<8;return 32768&c?4294901760|c:c},d.prototype.readInt16BE=function(a,b){b||q(a,2,this.length);var c=this[a+1]|this[a]<<8;return 32768&c?4294901760|c:c},d.prototype.readInt32LE=function(a,b){return b||q(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},d.prototype.readInt32BE=function(a,b){return b||q(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},d.prototype.readFloatLE=function(a,b){return b||q(a,4,this.length),I.read(this,a,!0,23,4)},d.prototype.readFloatBE=function(a,b){return b||q(a,4,this.length),I.read(this,a,!1,23,4)},d.prototype.readDoubleLE=function(a,b){return b||q(a,8,this.length),I.read(this,a,!0,52,8)},d.prototype.readDoubleBE=function(a,b){return b||q(a,8,this.length),I.read(this,a,!1,52,8)},d.prototype.writeUInt8=function(a,b,c){return a=+a,b>>>=0,c||r(this,a,b,1,255,0),d.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),this[b]=a,b+1},d.prototype.writeUInt16LE=function(a,b,c){return a=+a,b>>>=0,c||r(this,a,b,2,65535,0),d.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8):s(this,a,b,!0),b+2},d.prototype.writeUInt16BE=function(a,b,c){return a=+a,b>>>=0,c||r(this,a,b,2,65535,0),d.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=a):s(this,a,b,!1),b+2},d.prototype.writeUInt32LE=function(a,b,c){return a=+a,b>>>=0,c||r(this,a,b,4,4294967295,0),d.TYPED_ARRAY_SUPPORT?(this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=a):t(this,a,b,!0),b+4},d.prototype.writeUInt32BE=function(a,b,c){return a=+a,b>>>=0,c||r(this,a,b,4,4294967295,0),d.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=a):t(this,a,b,!1),b+4},d.prototype.writeInt8=function(a,b,c){return a=+a,b>>>=0,c||r(this,a,b,1,127,-128),d.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),0>a&&(a=255+a+1),this[b]=a,b+1},d.prototype.writeInt16LE=function(a,b,c){return a=+a,b>>>=0,c||r(this,a,b,2,32767,-32768),d.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8):s(this,a,b,!0),b+2},d.prototype.writeInt16BE=function(a,b,c){return a=+a,b>>>=0,c||r(this,a,b,2,32767,-32768),d.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=a):s(this,a,b,!1),b+2},d.prototype.writeInt32LE=function(a,b,c){return a=+a,b>>>=0,c||r(this,a,b,4,2147483647,-2147483648),d.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24):t(this,a,b,!0),b+4},d.prototype.writeInt32BE=function(a,b,c){return a=+a,b>>>=0,c||r(this,a,b,4,2147483647,-2147483648),0>a&&(a=4294967295+a+1),d.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=a):t(this,a,b,!1),b+4},d.prototype.writeFloatLE=function(a,b,c){return v(this,a,b,!0,c)},d.prototype.writeFloatBE=function(a,b,c){return v(this,a,b,!1,c)},d.prototype.writeDoubleLE=function(a,b,c){return w(this,a,b,!0,c)},d.prototype.writeDoubleBE=function(a,b,c){return w(this,a,b,!1,c)},d.prototype.copy=function(a,b,c,e){var f=this;if(c||(c=0),e||0===e||(e=this.length),b||(b=0),e!==c&&0!==a.length&&0!==f.length){if(c>e)throw new TypeError("sourceEnd < sourceStart");if(0>b||b>=a.length)throw new TypeError("targetStart out of bounds");if(0>c||c>=f.length)throw new TypeError("sourceStart out of bounds");if(0>e||e>f.length)throw new TypeError("sourceEnd out of bounds");e>this.length&&(e=this.length),a.length-b<e-c&&(e=a.length-b+c);var g=e-c;if(1e3>g||!d.TYPED_ARRAY_SUPPORT)for(var h=0;g>h;h++)a[h+b]=this[h+c];else a._set(this.subarray(c,c+g),b)}},d.prototype.fill=function(a,b,c){if(a||(a=0),b||(b=0),c||(c=this.length),b>c)throw new TypeError("end < start");if(c!==b&&0!==this.length){if(0>b||b>=this.length)throw new TypeError("start out of bounds");if(0>c||c>this.length)throw new TypeError("end out of bounds");var d;if("number"==typeof a)for(d=b;c>d;d++)this[d]=a;else{var e=B(a.toString()),f=e.length;for(d=b;c>d;d++)this[d]=e[d%f]}return this}},d.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(d.TYPED_ARRAY_SUPPORT)return new d(this).buffer;for(var a=new Uint8Array(this.length),b=0,c=a.length;c>b;b+=1)a[b]=this[b];return a.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var L=d.prototype;d._augment=function(a){return a.constructor=d,a._isBuffer=!0,a._get=a.get,a._set=a.set,a.get=L.get,a.set=L.set,a.write=L.write,a.toString=L.toString,a.toLocaleString=L.toString,a.toJSON=L.toJSON,a.equals=L.equals,a.compare=L.compare,a.copy=L.copy,a.slice=L.slice,a.readUInt8=L.readUInt8,a.readUInt16LE=L.readUInt16LE,a.readUInt16BE=L.readUInt16BE,a.readUInt32LE=L.readUInt32LE,a.readUInt32BE=L.readUInt32BE,a.readInt8=L.readInt8,a.readInt16LE=L.readInt16LE,a.readInt16BE=L.readInt16BE,a.readInt32LE=L.readInt32LE,a.readInt32BE=L.readInt32BE,a.readFloatLE=L.readFloatLE,a.readFloatBE=L.readFloatBE,a.readDoubleLE=L.readDoubleLE,a.readDoubleBE=L.readDoubleBE,a.writeUInt8=L.writeUInt8,a.writeUInt16LE=L.writeUInt16LE,a.writeUInt16BE=L.writeUInt16BE,a.writeUInt32LE=L.writeUInt32LE,a.writeUInt32BE=L.writeUInt32BE,a.writeInt8=L.writeInt8,a.writeInt16LE=L.writeInt16LE,a.writeInt16BE=L.writeInt16BE,a.writeInt32LE=L.writeInt32LE,a.writeInt32BE=L.writeInt32BE,a.writeFloatLE=L.writeFloatLE,a.writeFloatBE=L.writeFloatBE,a.writeDoubleLE=L.writeDoubleLE,a.writeDoubleBE=L.writeDoubleBE,a.fill=L.fill,a.inspect=L.inspect,a.toArrayBuffer=L.toArrayBuffer,a};var M=/[^+\/0-9A-z]/g},{"base64-js":26,ieee754:27,"is-array":28}],26:[function(a,b,c){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(a){"use strict";function b(a){var b=a.charCodeAt(0);return b===g?62:b===h?63:i>b?-1:i+10>b?b-i+26+26:k+26>b?b-k:j+26>b?b-j+26:void 0}function c(a){function c(a){j[l++]=a}var d,e,g,h,i,j;if(a.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var k=a.length;i="="===a.charAt(k-2)?2:"="===a.charAt(k-1)?1:0,j=new f(3*a.length/4-i),g=i>0?a.length-4:a.length;var l=0;for(d=0,e=0;g>d;d+=4,e+=3)h=b(a.charAt(d))<<18|b(a.charAt(d+1))<<12|b(a.charAt(d+2))<<6|b(a.charAt(d+3)),c((16711680&h)>>16),c((65280&h)>>8),c(255&h);return 2===i?(h=b(a.charAt(d))<<2|b(a.charAt(d+1))>>4,c(255&h)):1===i&&(h=b(a.charAt(d))<<10|b(a.charAt(d+1))<<4|b(a.charAt(d+2))>>2,c(h>>8&255),c(255&h)),j}function e(a){function b(a){return d.charAt(a)}function c(a){return b(a>>18&63)+b(a>>12&63)+b(a>>6&63)+b(63&a)}var e,f,g,h=a.length%3,i="";for(e=0,g=a.length-h;g>e;e+=3)f=(a[e]<<16)+(a[e+1]<<8)+a[e+2],i+=c(f);switch(h){case 1:f=a[a.length-1],i+=b(f>>2),i+=b(f<<4&63),i+="==";break;case 2:f=(a[a.length-2]<<8)+a[a.length-1],i+=b(f>>10),i+=b(f>>4&63),i+=b(f<<2&63),i+="="}return i}var f="undefined"!=typeof Uint8Array?Uint8Array:Array,g="+".charCodeAt(0),h="/".charCodeAt(0),i="0".charCodeAt(0),j="a".charCodeAt(0),k="A".charCodeAt(0);a.toByteArray=c,a.fromByteArray=e}("undefined"==typeof c?this.base64js={}:c)},{}],27:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:(n?-1:1)*(1/0);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=0>b||0===b&&0>1/b?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],28:[function(a,b,c){var d=Array.isArray,e=Object.prototype.toString;b.exports=d||function(a){return!!a&&"[object Array]"==e.call(a)}},{}],29:[function(a,b,c){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(a){return"function"==typeof a}function f(a){return"number"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){return void 0===a}b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(a){if(!f(a)||0>a||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},d.prototype.emit=function(a){var b,c,d,f,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;throw TypeError('Uncaught, unspecified "error" event.')}if(c=this._events[a],h(c))return!1;if(e(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(d=arguments.length,f=new Array(d-1),i=1;d>i;i++)f[i-1]=arguments[i];c.apply(this,f)}else if(g(c)){for(d=arguments.length,f=new Array(d-1),i=1;d>i;i++)f[i-1]=arguments[i];for(j=c.slice(),d=j.length,i=0;d>i;i++)j[i].apply(this,f)}return!0},d.prototype.addListener=function(a,b){var c;if(!e(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e(b.listener)?b.listener:b),this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,g(this._events[a])&&!this._events[a].warned){var c;c=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())}return this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(a,b){function c(){this.removeListener(a,c),d||(d=!0,b.apply(this,arguments))}if(!e(b))throw TypeError("listener must be a function");var d=!1;return c.listener=b,this.on(a,c),this},d.prototype.removeListener=function(a,b){var c,d,f,h;if(!e(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(g(c)){for(h=f;h-->0;)if(c[h]===b||c[h].listener&&c[h].listener===b){d=h;break}if(0>d)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},d.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},d.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?e(this._events[a])?[this._events[a]]:this._events[a].slice():[]},d.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?e(a._events[b])?1:a._events[b].length:0}},{}],30:[function(a,b,c){"function"==typeof Object.create?b.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],31:[function(a,b,c){b.exports=Array.isArray||function(a){return"[object Array]"==Object.prototype.toString.call(a)}},{}],32:[function(a,c,d){(function(a){!function(e){function f(a){throw RangeError(I[a])}function g(a,b){for(var c=a.length;c--;)a[c]=b(a[c]);return a}function h(a,b){return g(a.split(H),b).join(".")}function i(a){for(var b,c,d=[],e=0,f=a.length;f>e;)b=a.charCodeAt(e++),b>=55296&&56319>=b&&f>e?(c=a.charCodeAt(e++),56320==(64512&c)?d.push(((1023&b)<<10)+(1023&c)+65536):(d.push(b),e--)):d.push(b);return d}function j(a){return g(a,function(a){var b="";return a>65535&&(a-=65536,b+=L(a>>>10&1023|55296),a=56320|1023&a),b+=L(a)}).join("")}function k(a){return 10>a-48?a-22:26>a-65?a-65:26>a-97?a-97:x}function l(a,b){return a+22+75*(26>a)-((0!=b)<<5)}function m(a,b,c){var d=0;for(a=c?K(a/B):a>>1,a+=K(a/b);a>J*z>>1;d+=x)a=K(a/J);return K(d+(J+1)*a/(a+A))}function n(a){var b,c,d,e,g,h,i,l,n,o,p=[],q=a.length,r=0,s=D,t=C;for(c=a.lastIndexOf(E),0>c&&(c=0),d=0;c>d;++d)a.charCodeAt(d)>=128&&f("not-basic"),p.push(a.charCodeAt(d));for(e=c>0?c+1:0;q>e;){for(g=r,h=1,i=x;e>=q&&f("invalid-input"),l=k(a.charCodeAt(e++)),(l>=x||l>K((w-r)/h))&&f("overflow"),r+=l*h,n=t>=i?y:i>=t+z?z:i-t,!(n>l);i+=x)o=x-n,h>K(w/o)&&f("overflow"),h*=o;b=p.length+1,t=m(r-g,b,0==g),K(r/b)>w-s&&f("overflow"),s+=K(r/b),r%=b,p.splice(r++,0,s)}return j(p)}function o(a){var b,c,d,e,g,h,j,k,n,o,p,q,r,s,t,u=[];for(a=i(a),q=a.length,b=D,c=0,g=C,h=0;q>h;++h)p=a[h],128>p&&u.push(L(p));for(d=e=u.length,e&&u.push(E);q>d;){for(j=w,h=0;q>h;++h)p=a[h],p>=b&&j>p&&(j=p);for(r=d+1,j-b>K((w-c)/r)&&f("overflow"),c+=(j-b)*r,b=j,h=0;q>h;++h)if(p=a[h],b>p&&++c>w&&f("overflow"),p==b){for(k=c,n=x;o=g>=n?y:n>=g+z?z:n-g,!(o>k);n+=x)t=k-o,s=x-o,u.push(L(l(o+t%s,0))),k=K(t/s);u.push(L(l(k,0))),g=m(c,r,d==e),c=0,++d}++c,++b}return u.join("")}function p(a){return h(a,function(a){return F.test(a)?n(a.slice(4).toLowerCase()):a})}function q(a){return h(a,function(a){return G.test(a)?"xn--"+o(a):a})}var r="object"==typeof d&&d,s="object"==typeof c&&c&&c.exports==r&&c,t="object"==typeof a&&a;(t.global===t||t.window===t)&&(e=t);var u,v,w=2147483647,x=36,y=1,z=26,A=38,B=700,C=72,D=128,E="-",F=/^xn--/,G=/[^ -~]/,H=/\x2E|\u3002|\uFF0E|\uFF61/g,I={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},J=x-y,K=Math.floor,L=String.fromCharCode;if(u={version:"1.2.4",ucs2:{decode:i,encode:j},decode:n,encode:o,toASCII:q,toUnicode:p},"function"==typeof b&&"object"==typeof b.amd&&b.amd)b("punycode",function(){return u});else if(r&&!r.nodeType)if(s)s.exports=u;else for(v in u)u.hasOwnProperty(v)&&(r[v]=u[v]);else e.punycode=u}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],33:[function(a,b,c){"use strict";function d(a,b){return Object.prototype.hasOwnProperty.call(a,b)}b.exports=function(a,b,c,f){b=b||"&",c=c||"=";var g={};if("string"!=typeof a||0===a.length)return g;var h=/\+/g;a=a.split(b);var i=1e3;f&&"number"==typeof f.maxKeys&&(i=f.maxKeys);var j=a.length;i>0&&j>i&&(j=i);for(var k=0;j>k;++k){var l,m,n,o,p=a[k].replace(h,"%20"),q=p.indexOf(c);q>=0?(l=p.substr(0,q),m=p.substr(q+1)):(l=p,m=""),n=decodeURIComponent(l),o=decodeURIComponent(m),d(g,n)?e(g[n])?g[n].push(o):g[n]=[g[n],o]:g[n]=o}return g};var e=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}},{}],34:[function(a,b,c){"use strict";function d(a,b){if(a.map)return a.map(b);for(var c=[],d=0;d<a.length;d++)c.push(b(a[d],d));return c}var e=function(a){switch(typeof a){case"string":return a;case"boolean":return a?"true":"false";case"number":return isFinite(a)?a:"";default:return""}};b.exports=function(a,b,c,h){return b=b||"&",c=c||"=",null===a&&(a=void 0),"object"==typeof a?d(g(a),function(g){var h=encodeURIComponent(e(g))+c;return f(a[g])?d(a[g],function(a){return h+encodeURIComponent(e(a))}).join(b):h+encodeURIComponent(e(a[g]))}).join(b):h?encodeURIComponent(e(h))+c+encodeURIComponent(e(a)):""};var f=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},g=Object.keys||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}},{}],35:[function(a,b,c){"use strict";c.decode=c.parse=a("./decode"),c.encode=c.stringify=a("./encode")},{"./decode":33,"./encode":34}],36:[function(a,b,c){b.exports=a("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":37}],37:[function(a,b,c){(function(c){function d(a){return this instanceof d?(i.call(this,a),j.call(this,a),a&&a.readable===!1&&(this.readable=!1),a&&a.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,a&&a.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",e)):new d(a)}function e(){this.allowHalfOpen||this._writableState.ended||c.nextTick(this.end.bind(this))}function f(a,b){for(var c=0,d=a.length;d>c;c++)b(a[c],c)}b.exports=d;var g=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b},h=a("core-util-is");h.inherits=a("inherits");var i=a("./_stream_readable"),j=a("./_stream_writable");h.inherits(d,i),f(g(j.prototype),function(a){d.prototype[a]||(d.prototype[a]=j.prototype[a])})}).call(this,a("/home/josh/src/imjs/node_modules/insert-module-globals/node_modules/process/browser.js"))},{"./_stream_readable":39,"./_stream_writable":41,"/home/josh/src/imjs/node_modules/insert-module-globals/node_modules/process/browser.js":57,"core-util-is":42,inherits:30}],38:[function(a,b,c){function d(a){return this instanceof d?void e.call(this,a):new d(a)}b.exports=d;var e=a("./_stream_transform"),f=a("core-util-is");f.inherits=a("inherits"),f.inherits(d,e),d.prototype._transform=function(a,b,c){c(null,a)}},{"./_stream_transform":40,"core-util-is":42,inherits:30}],39:[function(a,b,c){(function(c){function d(b,c){var d=a("./_stream_duplex");b=b||{};var e=b.highWaterMark,f=b.objectMode?16:16384;this.highWaterMark=e||0===e?e:f,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!b.objectMode,c instanceof d&&(this.objectMode=this.objectMode||!!b.readableObjectMode),this.defaultEncoding=b.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,b.encoding&&(C||(C=a("string_decoder/").StringDecoder),this.decoder=new C(b.encoding),this.encoding=b.encoding)}function e(b){a("./_stream_duplex");return this instanceof e?(this._readableState=new d(b,this),this.readable=!0,void A.call(this)):new e(b)}function f(a,b,c,d,e){var f=j(b,c);if(f)a.emit("error",f);else if(B.isNullOrUndefined(c))b.reading=!1,b.ended||k(a,b);else if(b.objectMode||c&&c.length>0)if(b.ended&&!e){var h=new Error("stream.push() after EOF");a.emit("error",h)}else if(b.endEmitted&&e){var h=new Error("stream.unshift() after end event");a.emit("error",h)}else!b.decoder||e||d||(c=b.decoder.write(c)),e||(b.reading=!1),b.flowing&&0===b.length&&!b.sync?(a.emit("data",c),a.read(0)):(b.length+=b.objectMode?1:c.length,e?b.buffer.unshift(c):b.buffer.push(c),b.needReadable&&l(a)),n(a,b);else e||(b.reading=!1);return g(b)}function g(a){return!a.ended&&(a.needReadable||a.length<a.highWaterMark||0===a.length)}function h(a){if(a>=E)a=E;else{a--;for(var b=1;32>b;b<<=1)a|=a>>b;a++}return a}function i(a,b){return 0===b.length&&b.ended?0:b.objectMode?0===a?0:1:isNaN(a)||B.isNull(a)?b.flowing&&b.buffer.length?b.buffer[0].length:b.length:0>=a?0:(a>b.highWaterMark&&(b.highWaterMark=h(a)),a>b.length?b.ended?b.length:(b.needReadable=!0,0):a)}function j(a,b){var c=null;return B.isBuffer(b)||B.isString(b)||B.isNullOrUndefined(b)||a.objectMode||(c=new TypeError("Invalid non-string/buffer chunk")),c}function k(a,b){if(b.decoder&&!b.ended){var c=b.decoder.end();c&&c.length&&(b.buffer.push(c),b.length+=b.objectMode?1:c.length)}b.ended=!0,l(a)}function l(a){var b=a._readableState;b.needReadable=!1,b.emittedReadable||(D("emitReadable",b.flowing),b.emittedReadable=!0,b.sync?c.nextTick(function(){m(a)}):m(a))}function m(a){D("emit readable"),a.emit("readable"),s(a)}function n(a,b){b.readingMore||(b.readingMore=!0,c.nextTick(function(){o(a,b)}))}function o(a,b){for(var c=b.length;!b.reading&&!b.flowing&&!b.ended&&b.length<b.highWaterMark&&(D("maybeReadMore read 0"),a.read(0),c!==b.length);)c=b.length;b.readingMore=!1}function p(a){return function(){var b=a._readableState;D("pipeOnDrain",b.awaitDrain),b.awaitDrain&&b.awaitDrain--,0===b.awaitDrain&&z.listenerCount(a,"data")&&(b.flowing=!0,s(a))}}function q(a,b){b.resumeScheduled||(b.resumeScheduled=!0,c.nextTick(function(){r(a,b)}))}function r(a,b){b.resumeScheduled=!1,a.emit("resume"),s(a),b.flowing&&!b.reading&&a.read(0)}function s(a){var b=a._readableState;if(D("flow",b.flowing),b.flowing)do var c=a.read();while(null!==c&&b.flowing)}function t(a,b){var c,d=b.buffer,e=b.length,f=!!b.decoder,g=!!b.objectMode;if(0===d.length)return null;if(0===e)c=null;else if(g)c=d.shift();else if(!a||a>=e)c=f?d.join(""):y.concat(d,e),d.length=0;else if(a<d[0].length){var h=d[0];c=h.slice(0,a),d[0]=h.slice(a)}else if(a===d[0].length)c=d.shift();else{c=f?"":new y(a);for(var i=0,j=0,k=d.length;k>j&&a>i;j++){var h=d[0],l=Math.min(a-i,h.length);f?c+=h.slice(0,l):h.copy(c,i,0,l),l<h.length?d[0]=h.slice(l):d.shift(),i+=l}}return c}function u(a){var b=a._readableState;if(b.length>0)throw new Error("endReadable called on non-empty stream");b.endEmitted||(b.ended=!0,c.nextTick(function(){b.endEmitted||0!==b.length||(b.endEmitted=!0,a.readable=!1,a.emit("end"))}))}function v(a,b){for(var c=0,d=a.length;d>c;c++)b(a[c],c)}function w(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1}b.exports=e;var x=a("isarray"),y=a("buffer").Buffer;e.ReadableState=d;var z=a("events").EventEmitter;z.listenerCount||(z.listenerCount=function(a,b){return a.listeners(b).length});var A=a("stream"),B=a("core-util-is");B.inherits=a("inherits");var C,D=a("util");D=D&&D.debuglog?D.debuglog("stream"):function(){},B.inherits(e,A),e.prototype.push=function(a,b){var c=this._readableState;return B.isString(a)&&!c.objectMode&&(b=b||c.defaultEncoding,b!==c.encoding&&(a=new y(a,b),b="")),f(this,c,a,b,!1)},e.prototype.unshift=function(a){var b=this._readableState;return f(this,b,a,"",!0)},e.prototype.setEncoding=function(b){return C||(C=a("string_decoder/").StringDecoder),this._readableState.decoder=new C(b),this._readableState.encoding=b,this};var E=8388608;e.prototype.read=function(a){D("read",a);var b=this._readableState,c=a;if((!B.isNumber(a)||a>0)&&(b.emittedReadable=!1),0===a&&b.needReadable&&(b.length>=b.highWaterMark||b.ended))return D("read: emitReadable",b.length,b.ended),0===b.length&&b.ended?u(this):l(this),null;if(a=i(a,b),0===a&&b.ended)return 0===b.length&&u(this),null;var d=b.needReadable;D("need readable",d),(0===b.length||b.length-a<b.highWaterMark)&&(d=!0,D("length less than watermark",d)),(b.ended||b.reading)&&(d=!1,D("reading or ended",d)),d&&(D("do read"),b.reading=!0,b.sync=!0,0===b.length&&(b.needReadable=!0),this._read(b.highWaterMark),b.sync=!1),d&&!b.reading&&(a=i(c,b));var e;return e=a>0?t(a,b):null,B.isNull(e)&&(b.needReadable=!0,a=0),b.length-=a,0!==b.length||b.ended||(b.needReadable=!0),c!==a&&b.ended&&0===b.length&&u(this),B.isNull(e)||this.emit("data",e),e},e.prototype._read=function(a){this.emit("error",new Error("not implemented"))},e.prototype.pipe=function(a,b){function d(a){D("onunpipe"),a===l&&f()}function e(){D("onend"),a.end()}function f(){D("cleanup"),a.removeListener("close",i),a.removeListener("finish",j),a.removeListener("drain",q),a.removeListener("error",h),a.removeListener("unpipe",d),l.removeListener("end",e),l.removeListener("end",f),l.removeListener("data",g),!m.awaitDrain||a._writableState&&!a._writableState.needDrain||q()}function g(b){D("ondata");var c=a.write(b);!1===c&&(D("false write response, pause",l._readableState.awaitDrain),l._readableState.awaitDrain++,l.pause())}function h(b){D("onerror",b),k(),a.removeListener("error",h),0===z.listenerCount(a,"error")&&a.emit("error",b)}function i(){a.removeListener("finish",j),k()}function j(){D("onfinish"),a.removeListener("close",i),k()}function k(){D("unpipe"),l.unpipe(a)}var l=this,m=this._readableState;switch(m.pipesCount){case 0:m.pipes=a;break;case 1:m.pipes=[m.pipes,a];break;default:m.pipes.push(a)}m.pipesCount+=1,D("pipe count=%d opts=%j",m.pipesCount,b);var n=(!b||b.end!==!1)&&a!==c.stdout&&a!==c.stderr,o=n?e:f;m.endEmitted?c.nextTick(o):l.once("end",o),a.on("unpipe",d);var q=p(l);return a.on("drain",q),l.on("data",g),a._events&&a._events.error?x(a._events.error)?a._events.error.unshift(h):a._events.error=[h,a._events.error]:a.on("error",h),a.once("close",i),a.once("finish",j),a.emit("pipe",l),m.flowing||(D("pipe resume"),l.resume()),a},e.prototype.unpipe=function(a){var b=this._readableState;if(0===b.pipesCount)return this;if(1===b.pipesCount)return a&&a!==b.pipes?this:(a||(a=b.pipes),b.pipes=null,b.pipesCount=0,b.flowing=!1,a&&a.emit("unpipe",this),this);if(!a){var c=b.pipes,d=b.pipesCount;b.pipes=null,b.pipesCount=0,b.flowing=!1;for(var e=0;d>e;e++)c[e].emit("unpipe",this);return this}var e=w(b.pipes,a);return-1===e?this:(b.pipes.splice(e,1),b.pipesCount-=1,1===b.pipesCount&&(b.pipes=b.pipes[0]),a.emit("unpipe",this),this)},e.prototype.on=function(a,b){var d=A.prototype.on.call(this,a,b);if("data"===a&&!1!==this._readableState.flowing&&this.resume(),"readable"===a&&this.readable){var e=this._readableState;if(!e.readableListening)if(e.readableListening=!0,
e.emittedReadable=!1,e.needReadable=!0,e.reading)e.length&&l(this,e);else{var f=this;c.nextTick(function(){D("readable nexttick read 0"),f.read(0)})}}return d},e.prototype.addListener=e.prototype.on,e.prototype.resume=function(){var a=this._readableState;return a.flowing||(D("resume"),a.flowing=!0,a.reading||(D("resume read 0"),this.read(0)),q(this,a)),this},e.prototype.pause=function(){return D("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(D("pause"),this._readableState.flowing=!1,this.emit("pause")),this},e.prototype.wrap=function(a){var b=this._readableState,c=!1,d=this;a.on("end",function(){if(D("wrapped end"),b.decoder&&!b.ended){var a=b.decoder.end();a&&a.length&&d.push(a)}d.push(null)}),a.on("data",function(e){if(D("wrapped data"),b.decoder&&(e=b.decoder.write(e)),e&&(b.objectMode||e.length)){var f=d.push(e);f||(c=!0,a.pause())}});for(var e in a)B.isFunction(a[e])&&B.isUndefined(this[e])&&(this[e]=function(b){return function(){return a[b].apply(a,arguments)}}(e));var f=["error","close","destroy","pause","resume"];return v(f,function(b){a.on(b,d.emit.bind(d,b))}),d._read=function(b){D("wrapped _read",b),c&&(c=!1,a.resume())},d},e._fromList=t}).call(this,a("/home/josh/src/imjs/node_modules/insert-module-globals/node_modules/process/browser.js"))},{"./_stream_duplex":37,"/home/josh/src/imjs/node_modules/insert-module-globals/node_modules/process/browser.js":57,buffer:25,"core-util-is":42,events:29,inherits:30,isarray:31,stream:47,"string_decoder/":48,util:24}],40:[function(a,b,c){function d(a,b){this.afterTransform=function(a,c){return e(b,a,c)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function e(a,b,c){var d=a._transformState;d.transforming=!1;var e=d.writecb;if(!e)return a.emit("error",new Error("no writecb in Transform class"));d.writechunk=null,d.writecb=null,i.isNullOrUndefined(c)||a.push(c),e&&e(b);var f=a._readableState;f.reading=!1,(f.needReadable||f.length<f.highWaterMark)&&a._read(f.highWaterMark)}function f(a){if(!(this instanceof f))return new f(a);h.call(this,a),this._transformState=new d(a,this);var b=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("prefinish",function(){i.isFunction(this._flush)?this._flush(function(a){g(b,a)}):g(b)})}function g(a,b){if(b)return a.emit("error",b);var c=a._writableState,d=a._transformState;if(c.length)throw new Error("calling transform done when ws.length != 0");if(d.transforming)throw new Error("calling transform done when still transforming");return a.push(null)}b.exports=f;var h=a("./_stream_duplex"),i=a("core-util-is");i.inherits=a("inherits"),i.inherits(f,h),f.prototype.push=function(a,b){return this._transformState.needTransform=!1,h.prototype.push.call(this,a,b)},f.prototype._transform=function(a,b,c){throw new Error("not implemented")},f.prototype._write=function(a,b,c){var d=this._transformState;if(d.writecb=c,d.writechunk=a,d.writeencoding=b,!d.transforming){var e=this._readableState;(d.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark)}},f.prototype._read=function(a){var b=this._transformState;i.isNull(b.writechunk)||!b.writecb||b.transforming?b.needTransform=!0:(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform))}},{"./_stream_duplex":37,"core-util-is":42,inherits:30}],41:[function(a,b,c){(function(c){function d(a,b,c){this.chunk=a,this.encoding=b,this.callback=c}function e(b,c){var d=a("./_stream_duplex");b=b||{};var e=b.highWaterMark,f=b.objectMode?16:16384;this.highWaterMark=e||0===e?e:f,this.objectMode=!!b.objectMode,c instanceof d&&(this.objectMode=this.objectMode||!!b.writableObjectMode),this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var g=b.decodeStrings===!1;this.decodeStrings=!g,this.defaultEncoding=b.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){n(c,a)},this.writecb=null,this.writelen=0,this.buffer=[],this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function f(b){var c=a("./_stream_duplex");return this instanceof f||this instanceof c?(this._writableState=new e(b,this),this.writable=!0,void x.call(this)):new f(b)}function g(a,b,d){var e=new Error("write after end");a.emit("error",e),c.nextTick(function(){d(e)})}function h(a,b,d,e){var f=!0;if(!(w.isBuffer(d)||w.isString(d)||w.isNullOrUndefined(d)||b.objectMode)){var g=new TypeError("Invalid non-string/buffer chunk");a.emit("error",g),c.nextTick(function(){e(g)}),f=!1}return f}function i(a,b,c){return!a.objectMode&&a.decodeStrings!==!1&&w.isString(b)&&(b=new v(b,c)),b}function j(a,b,c,e,f){c=i(b,c,e),w.isBuffer(c)&&(e="buffer");var g=b.objectMode?1:c.length;b.length+=g;var h=b.length<b.highWaterMark;return h||(b.needDrain=!0),b.writing||b.corked?b.buffer.push(new d(c,e,f)):k(a,b,!1,g,c,e,f),h}function k(a,b,c,d,e,f,g){b.writelen=d,b.writecb=g,b.writing=!0,b.sync=!0,c?a._writev(e,b.onwrite):a._write(e,f,b.onwrite),b.sync=!1}function l(a,b,d,e,f){d?c.nextTick(function(){b.pendingcb--,f(e)}):(b.pendingcb--,f(e)),a._writableState.errorEmitted=!0,a.emit("error",e)}function m(a){a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0}function n(a,b){var d=a._writableState,e=d.sync,f=d.writecb;if(m(d),b)l(a,d,e,b,f);else{var g=r(a,d);g||d.corked||d.bufferProcessing||!d.buffer.length||q(a,d),e?c.nextTick(function(){o(a,d,g,f)}):o(a,d,g,f)}}function o(a,b,c,d){c||p(a,b),b.pendingcb--,d(),t(a,b)}function p(a,b){0===b.length&&b.needDrain&&(b.needDrain=!1,a.emit("drain"))}function q(a,b){if(b.bufferProcessing=!0,a._writev&&b.buffer.length>1){for(var c=[],d=0;d<b.buffer.length;d++)c.push(b.buffer[d].callback);b.pendingcb++,k(a,b,!0,b.length,b.buffer,"",function(a){for(var d=0;d<c.length;d++)b.pendingcb--,c[d](a)}),b.buffer=[]}else{for(var d=0;d<b.buffer.length;d++){var e=b.buffer[d],f=e.chunk,g=e.encoding,h=e.callback,i=b.objectMode?1:f.length;if(k(a,b,!1,i,f,g,h),b.writing){d++;break}}d<b.buffer.length?b.buffer=b.buffer.slice(d):b.buffer.length=0}b.bufferProcessing=!1}function r(a,b){return b.ending&&0===b.length&&!b.finished&&!b.writing}function s(a,b){b.prefinished||(b.prefinished=!0,a.emit("prefinish"))}function t(a,b){var c=r(a,b);return c&&(0===b.pendingcb?(s(a,b),b.finished=!0,a.emit("finish")):s(a,b)),c}function u(a,b,d){b.ending=!0,t(a,b),d&&(b.finished?c.nextTick(d):a.once("finish",d)),b.ended=!0}b.exports=f;var v=a("buffer").Buffer;f.WritableState=e;var w=a("core-util-is");w.inherits=a("inherits");var x=a("stream");w.inherits(f,x),f.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},f.prototype.write=function(a,b,c){var d=this._writableState,e=!1;return w.isFunction(b)&&(c=b,b=null),w.isBuffer(a)?b="buffer":b||(b=d.defaultEncoding),w.isFunction(c)||(c=function(){}),d.ended?g(this,d,c):h(this,d,a,c)&&(d.pendingcb++,e=j(this,d,a,b,c)),e},f.prototype.cork=function(){var a=this._writableState;a.corked++},f.prototype.uncork=function(){var a=this._writableState;a.corked&&(a.corked--,a.writing||a.corked||a.finished||a.bufferProcessing||!a.buffer.length||q(this,a))},f.prototype._write=function(a,b,c){c(new Error("not implemented"))},f.prototype._writev=null,f.prototype.end=function(a,b,c){var d=this._writableState;w.isFunction(a)?(c=a,a=null,b=null):w.isFunction(b)&&(c=b,b=null),w.isNullOrUndefined(a)||this.write(a,b),d.corked&&(d.corked=1,this.uncork()),d.ending||d.finished||u(this,d,c)}}).call(this,a("/home/josh/src/imjs/node_modules/insert-module-globals/node_modules/process/browser.js"))},{"./_stream_duplex":37,"/home/josh/src/imjs/node_modules/insert-module-globals/node_modules/process/browser.js":57,buffer:25,"core-util-is":42,inherits:30,stream:47}],42:[function(a,b,c){(function(a){function b(a){return Array.isArray(a)}function d(a){return"boolean"==typeof a}function e(a){return null===a}function f(a){return null==a}function g(a){return"number"==typeof a}function h(a){return"string"==typeof a}function i(a){return"symbol"==typeof a}function j(a){return void 0===a}function k(a){return l(a)&&"[object RegExp]"===r(a)}function l(a){return"object"==typeof a&&null!==a}function m(a){return l(a)&&"[object Date]"===r(a)}function n(a){return l(a)&&("[object Error]"===r(a)||a instanceof Error)}function o(a){return"function"==typeof a}function p(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function q(b){return a.isBuffer(b)}function r(a){return Object.prototype.toString.call(a)}c.isArray=b,c.isBoolean=d,c.isNull=e,c.isNullOrUndefined=f,c.isNumber=g,c.isString=h,c.isSymbol=i,c.isUndefined=j,c.isRegExp=k,c.isObject=l,c.isDate=m,c.isError=n,c.isFunction=o,c.isPrimitive=p,c.isBuffer=q}).call(this,a("buffer").Buffer)},{buffer:25}],43:[function(a,b,c){b.exports=a("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":38}],44:[function(a,b,c){c=b.exports=a("./lib/_stream_readable.js"),c.Stream=a("stream"),c.Readable=c,c.Writable=a("./lib/_stream_writable.js"),c.Duplex=a("./lib/_stream_duplex.js"),c.Transform=a("./lib/_stream_transform.js"),c.PassThrough=a("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":37,"./lib/_stream_passthrough.js":38,"./lib/_stream_readable.js":39,"./lib/_stream_transform.js":40,"./lib/_stream_writable.js":41,stream:47}],45:[function(a,b,c){b.exports=a("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":40}],46:[function(a,b,c){b.exports=a("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":41}],47:[function(a,b,c){function d(){e.call(this)}b.exports=d;var e=a("events").EventEmitter,f=a("inherits");f(d,e),d.Readable=a("readable-stream/readable.js"),d.Writable=a("readable-stream/writable.js"),d.Duplex=a("readable-stream/duplex.js"),d.Transform=a("readable-stream/transform.js"),d.PassThrough=a("readable-stream/passthrough.js"),d.Stream=d,d.prototype.pipe=function(a,b){function c(b){a.writable&&!1===a.write(b)&&j.pause&&j.pause()}function d(){j.readable&&j.resume&&j.resume()}function f(){k||(k=!0,a.end())}function g(){k||(k=!0,"function"==typeof a.destroy&&a.destroy())}function h(a){if(i(),0===e.listenerCount(this,"error"))throw a}function i(){j.removeListener("data",c),a.removeListener("drain",d),j.removeListener("end",f),j.removeListener("close",g),j.removeListener("error",h),a.removeListener("error",h),j.removeListener("end",i),j.removeListener("close",i),a.removeListener("close",i)}var j=this;j.on("data",c),a.on("drain",d),a._isStdio||b&&b.end===!1||(j.on("end",f),j.on("close",g));var k=!1;return j.on("error",h),a.on("error",h),j.on("end",i),j.on("close",i),a.on("close",i),a.emit("pipe",j),a}},{events:29,inherits:30,"readable-stream/duplex.js":36,"readable-stream/passthrough.js":43,"readable-stream/readable.js":44,"readable-stream/transform.js":45,"readable-stream/writable.js":46}],48:[function(a,b,c){function d(a){if(a&&!i(a))throw new Error("Unknown encoding: "+a)}function e(a){return a.toString(this.encoding)}function f(a){this.charReceived=a.length%2,this.charLength=this.charReceived?2:0}function g(a){this.charReceived=a.length%3,this.charLength=this.charReceived?3:0}var h=a("buffer").Buffer,i=h.isEncoding||function(a){switch(a&&a.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},j=c.StringDecoder=function(a){switch(this.encoding=(a||"utf8").toLowerCase().replace(/[-_]/,""),d(a),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=f;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=g;break;default:return void(this.write=e)}this.charBuffer=new h(6),this.charReceived=0,this.charLength=0};j.prototype.write=function(a){for(var b="";this.charLength;){var c=a.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:a.length;if(a.copy(this.charBuffer,this.charReceived,0,c),this.charReceived+=c,this.charReceived<this.charLength)return"";a=a.slice(c,a.length),b=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var d=b.charCodeAt(b.length-1);if(!(d>=55296&&56319>=d)){if(this.charReceived=this.charLength=0,0===a.length)return b;break}this.charLength+=this.surrogateSize,b=""}this.detectIncompleteChar(a);var e=a.length;this.charLength&&(a.copy(this.charBuffer,0,a.length-this.charReceived,e),e-=this.charReceived),b+=a.toString(this.encoding,0,e);var e=b.length-1,d=b.charCodeAt(e);if(d>=55296&&56319>=d){var f=this.surrogateSize;return this.charLength+=f,this.charReceived+=f,this.charBuffer.copy(this.charBuffer,f,0,f),a.copy(this.charBuffer,0,0,f),b.substring(0,e)}return b},j.prototype.detectIncompleteChar=function(a){for(var b=a.length>=3?3:a.length;b>0;b--){var c=a[a.length-b];if(1==b&&c>>5==6){this.charLength=2;break}if(2>=b&&c>>4==14){this.charLength=3;break}if(3>=b&&c>>3==30){this.charLength=4;break}}this.charReceived=b},j.prototype.end=function(a){var b="";if(a&&a.length&&(b=this.write(a)),this.charReceived){var c=this.charReceived,d=this.charBuffer,e=this.encoding;b+=d.slice(0,c).toString(e)}return b}},{buffer:25}],49:[function(a,b,c){function d(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function e(a,b,c){if(a&&j(a)&&a instanceof d)return a;var e=new d;return e.parse(a,b,c),e}function f(a){return i(a)&&(a=e(a)),a instanceof d?a.format():d.prototype.format.call(a)}function g(a,b){return e(a,!1,!0).resolve(b)}function h(a,b){return a?e(a,!1,!0).resolveObject(b):b}function i(a){return"string"==typeof a}function j(a){return"object"==typeof a&&null!==a}function k(a){return null===a}function l(a){return null==a}var m=a("punycode");c.parse=e,c.resolve=g,c.resolveObject=h,c.format=f,c.Url=d;var n=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,p=["<",">",'"',"`"," ","\r","\n","	"],q=["{","}","|","\\","^","`"].concat(p),r=["'"].concat(q),s=["%","/","?",";","#"].concat(r),t=["/","?","#"],u=255,v=/^[a-z0-9A-Z_-]{0,63}$/,w=/^([a-z0-9A-Z_-]{0,63})(.*)$/,x={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},z={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},A=a("querystring");d.prototype.parse=function(a,b,c){if(!i(a))throw new TypeError("Parameter 'url' must be a string, not "+typeof a);var d=a;d=d.trim();var e=n.exec(d);if(e){e=e[0];var f=e.toLowerCase();this.protocol=f,d=d.substr(e.length)}if(c||e||d.match(/^\/\/[^@\/]+@[^@\/]+/)){var g="//"===d.substr(0,2);!g||e&&y[e]||(d=d.substr(2),this.slashes=!0)}if(!y[e]&&(g||e&&!z[e])){for(var h=-1,j=0;j<t.length;j++){var k=d.indexOf(t[j]);-1!==k&&(-1===h||h>k)&&(h=k)}var l,o;o=-1===h?d.lastIndexOf("@"):d.lastIndexOf("@",h),-1!==o&&(l=d.slice(0,o),d=d.slice(o+1),this.auth=decodeURIComponent(l)),h=-1;for(var j=0;j<s.length;j++){var k=d.indexOf(s[j]);-1!==k&&(-1===h||h>k)&&(h=k)}-1===h&&(h=d.length),this.host=d.slice(0,h),d=d.slice(h),this.parseHost(),this.hostname=this.hostname||"";var p="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!p)for(var q=this.hostname.split(/\./),j=0,B=q.length;B>j;j++){var C=q[j];if(C&&!C.match(v)){for(var D="",E=0,F=C.length;F>E;E++)D+=C.charCodeAt(E)>127?"x":C[E];if(!D.match(v)){var G=q.slice(0,j),H=q.slice(j+1),I=C.match(w);I&&(G.push(I[1]),H.unshift(I[2])),H.length&&(d="/"+H.join(".")+d),this.hostname=G.join(".");break}}}if(this.hostname.length>u?this.hostname="":this.hostname=this.hostname.toLowerCase(),!p){for(var J=this.hostname.split("."),K=[],j=0;j<J.length;++j){var L=J[j];K.push(L.match(/[^A-Za-z0-9_-]/)?"xn--"+m.encode(L):L)}this.hostname=K.join(".")}var M=this.port?":"+this.port:"",N=this.hostname||"";this.host=N+M,this.href+=this.host,p&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==d[0]&&(d="/"+d))}if(!x[f])for(var j=0,B=r.length;B>j;j++){var O=r[j],P=encodeURIComponent(O);P===O&&(P=escape(O)),d=d.split(O).join(P)}var Q=d.indexOf("#");-1!==Q&&(this.hash=d.substr(Q),d=d.slice(0,Q));var R=d.indexOf("?");if(-1!==R?(this.search=d.substr(R),this.query=d.substr(R+1),b&&(this.query=A.parse(this.query)),d=d.slice(0,R)):b&&(this.search="",this.query={}),d&&(this.pathname=d),z[f]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var M=this.pathname||"",L=this.search||"";this.path=M+L}return this.href=this.format(),this},d.prototype.format=function(){var a=this.auth||"";a&&(a=encodeURIComponent(a),a=a.replace(/%3A/i,":"),a+="@");var b=this.protocol||"",c=this.pathname||"",d=this.hash||"",e=!1,f="";this.host?e=a+this.host:this.hostname&&(e=a+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(e+=":"+this.port)),this.query&&j(this.query)&&Object.keys(this.query).length&&(f=A.stringify(this.query));var g=this.search||f&&"?"+f||"";return b&&":"!==b.substr(-1)&&(b+=":"),this.slashes||(!b||z[b])&&e!==!1?(e="//"+(e||""),c&&"/"!==c.charAt(0)&&(c="/"+c)):e||(e=""),d&&"#"!==d.charAt(0)&&(d="#"+d),g&&"?"!==g.charAt(0)&&(g="?"+g),c=c.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),g=g.replace("#","%23"),b+e+c+g+d},d.prototype.resolve=function(a){return this.resolveObject(e(a,!1,!0)).format()},d.prototype.resolveObject=function(a){if(i(a)){var b=new d;b.parse(a,!1,!0),a=b}var c=new d;if(Object.keys(this).forEach(function(a){c[a]=this[a]},this),c.hash=a.hash,""===a.href)return c.href=c.format(),c;if(a.slashes&&!a.protocol)return Object.keys(a).forEach(function(b){"protocol"!==b&&(c[b]=a[b])}),z[c.protocol]&&c.hostname&&!c.pathname&&(c.path=c.pathname="/"),c.href=c.format(),c;if(a.protocol&&a.protocol!==c.protocol){if(!z[a.protocol])return Object.keys(a).forEach(function(b){c[b]=a[b]}),c.href=c.format(),c;if(c.protocol=a.protocol,a.host||y[a.protocol])c.pathname=a.pathname;else{for(var e=(a.pathname||"").split("/");e.length&&!(a.host=e.shift()););a.host||(a.host=""),a.hostname||(a.hostname=""),""!==e[0]&&e.unshift(""),e.length<2&&e.unshift(""),c.pathname=e.join("/")}if(c.search=a.search,c.query=a.query,c.host=a.host||"",c.auth=a.auth,c.hostname=a.hostname||a.host,c.port=a.port,c.pathname||c.search){var f=c.pathname||"",g=c.search||"";c.path=f+g}return c.slashes=c.slashes||a.slashes,c.href=c.format(),c}var h=c.pathname&&"/"===c.pathname.charAt(0),j=a.host||a.pathname&&"/"===a.pathname.charAt(0),m=j||h||c.host&&a.pathname,n=m,o=c.pathname&&c.pathname.split("/")||[],e=a.pathname&&a.pathname.split("/")||[],p=c.protocol&&!z[c.protocol];if(p&&(c.hostname="",c.port=null,c.host&&(""===o[0]?o[0]=c.host:o.unshift(c.host)),c.host="",a.protocol&&(a.hostname=null,a.port=null,a.host&&(""===e[0]?e[0]=a.host:e.unshift(a.host)),a.host=null),m=m&&(""===e[0]||""===o[0])),j)c.host=a.host||""===a.host?a.host:c.host,c.hostname=a.hostname||""===a.hostname?a.hostname:c.hostname,c.search=a.search,c.query=a.query,o=e;else if(e.length)o||(o=[]),o.pop(),o=o.concat(e),c.search=a.search,c.query=a.query;else if(!l(a.search)){if(p){c.hostname=c.host=o.shift();var q=c.host&&c.host.indexOf("@")>0?c.host.split("@"):!1;q&&(c.auth=q.shift(),c.host=c.hostname=q.shift())}return c.search=a.search,c.query=a.query,k(c.pathname)&&k(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.href=c.format(),c}if(!o.length)return c.pathname=null,c.search?c.path="/"+c.search:c.path=null,c.href=c.format(),c;for(var r=o.slice(-1)[0],s=(c.host||a.host)&&("."===r||".."===r)||""===r,t=0,u=o.length;u>=0;u--)r=o[u],"."==r?o.splice(u,1):".."===r?(o.splice(u,1),t++):t&&(o.splice(u,1),t--);if(!m&&!n)for(;t--;t)o.unshift("..");!m||""===o[0]||o[0]&&"/"===o[0].charAt(0)||o.unshift(""),s&&"/"!==o.join("/").substr(-1)&&o.push("");var v=""===o[0]||o[0]&&"/"===o[0].charAt(0);if(p){c.hostname=c.host=v?"":o.length?o.shift():"";var q=c.host&&c.host.indexOf("@")>0?c.host.split("@"):!1;q&&(c.auth=q.shift(),c.host=c.hostname=q.shift())}return m=m||c.host&&o.length,m&&!v&&o.unshift(""),o.length?c.pathname=o.join("/"):(c.pathname=null,c.path=null),k(c.pathname)&&k(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.auth=a.auth||c.auth,c.slashes=c.slashes||a.slashes,c.href=c.format(),c},d.prototype.parseHost=function(){var a=this.host,b=o.exec(a);b&&(b=b[0],":"!==b&&(this.port=b.substr(1)),a=a.substr(0,a.length-b.length)),a&&(this.hostname=a)}},{punycode:32,querystring:35}],50:[function(a,b,c){b.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},{}],51:[function(a,b,c){(function(b,d){function e(a,b){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),p(b)?d.showHidden=b:b&&c._extend(d,b),v(d.showHidden)&&(d.showHidden=!1),v(d.depth)&&(d.depth=2),v(d.colors)&&(d.colors=!1),v(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),i(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a,b){return a}function h(a){var b={};return a.forEach(function(a,c){b[a]=!0}),b}function i(a,b,d){if(a.customInspect&&b&&A(b.inspect)&&b.inspect!==c.inspect&&(!b.constructor||b.constructor.prototype!==b)){var e=b.inspect(d,a);return t(e)||(e=i(a,e,d)),e}var f=j(a,b);if(f)return f;var g=Object.keys(b),p=h(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(b)),z(b)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return k(b);if(0===g.length){if(A(b)){var q=b.name?": "+b.name:"";return a.stylize("[Function"+q+"]","special")}if(w(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(y(b))return a.stylize(Date.prototype.toString.call(b),"date");if(z(b))return k(b)}var r="",s=!1,u=["{","}"];if(o(b)&&(s=!0,u=["[","]"]),A(b)){var v=b.name?": "+b.name:"";r=" [Function"+v+"]"}if(w(b)&&(r=" "+RegExp.prototype.toString.call(b)),y(b)&&(r=" "+Date.prototype.toUTCString.call(b)),z(b)&&(r=" "+k(b)),0===g.length&&(!s||0==b.length))return u[0]+r+u[1];if(0>d)return w(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);var x;return x=s?l(a,b,d,p,g):g.map(function(c){return m(a,b,d,p,c,s)}),a.seen.pop(),n(x,r,u)}function j(a,b){if(v(b))return a.stylize("undefined","undefined");if(t(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return s(b)?a.stylize(""+b,"number"):p(b)?a.stylize(""+b,"boolean"):q(b)?a.stylize("null","null"):void 0}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function l(a,b,c,d,e){for(var f=[],g=0,h=b.length;h>g;++g)F(b,String(g))?f.push(m(a,b,c,d,String(g),!0)):f.push("");return e.forEach(function(e){e.match(/^\d+$/)||f.push(m(a,b,c,d,e,!0))}),f}function m(a,b,c,d,e,f){var g,h,j;if(j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},j.get?h=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(h=a.stylize("[Setter]","special")),F(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(j.value)<0?(h=q(c)?i(a,j.value,null):i(a,j.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),v(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function n(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function o(a){return Array.isArray(a)}function p(a){return"boolean"==typeof a}function q(a){return null===a}function r(a){return null==a}function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return"symbol"==typeof a}function v(a){return void 0===a}function w(a){return x(a)&&"[object RegExp]"===C(a)}function x(a){return"object"==typeof a&&null!==a}function y(a){return x(a)&&"[object Date]"===C(a)}function z(a){return x(a)&&("[object Error]"===C(a)||a instanceof Error)}function A(a){return"function"==typeof a}function B(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function C(a){return Object.prototype.toString.call(a)}function D(a){return 10>a?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,b=[D(a.getHours()),D(a.getMinutes()),D(a.getSeconds())].join(":");return[a.getDate(),J[a.getMonth()],b].join(" ")}function F(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var G=/%[sdj%]/g;c.format=function(a){if(!t(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(G,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(b){return"[Circular]"}default:return a}}),h=d[c];f>c;h=d[++c])g+=q(h)||!x(h)?" "+h:" "+e(h);return g},c.deprecate=function(a,e){function f(){if(!g){if(b.throwDeprecation)throw new Error(e);b.traceDeprecation?console.trace(e):console.error(e),g=!0}return a.apply(this,arguments)}if(v(d.process))return function(){return c.deprecate(a,e).apply(this,arguments)};if(b.noDeprecation===!0)return a;var g=!1;return f};var H,I={};c.debuglog=function(a){if(v(H)&&(H=b.env.NODE_DEBUG||""),a=a.toUpperCase(),!I[a])if(new RegExp("\\b"+a+"\\b","i").test(H)){var d=b.pid;I[a]=function(){var b=c.format.apply(c,arguments);console.error("%s %d: %s",a,d,b)}}else I[a]=function(){};return I[a]},c.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},c.isArray=o,c.isBoolean=p,c.isNull=q,c.isNullOrUndefined=r,c.isNumber=s,c.isString=t,c.isSymbol=u,c.isUndefined=v,c.isRegExp=w,c.isObject=x,c.isDate=y,c.isError=z,c.isFunction=A,c.isPrimitive=B,c.isBuffer=a("./support/isBuffer");var J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.log=function(){console.log("%s - %s",E(),c.format.apply(c,arguments))},c.inherits=a("inherits"),c._extend=function(a,b){if(!b||!x(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,a("/home/josh/src/imjs/node_modules/insert-module-globals/node_modules/process/browser.js"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":50,"/home/josh/src/imjs/node_modules/insert-module-globals/node_modules/process/browser.js":57,inherits:30}],52:[function(a,b,c){var d=b.exports,e=(a("events").EventEmitter,a("./lib/request")),f=a("url");d.request=function(a,b){"string"==typeof a&&(a=f.parse(a)),a||(a={}),a.host||a.port||(a.port=parseInt(window.location.port,10)),!a.host&&a.hostname&&(a.host=a.hostname),a.protocol||(a.scheme?a.protocol=a.scheme+":":a.protocol=window.location.protocol),a.host||(a.host=window.location.hostname||window.location.host),/:/.test(a.host)&&(a.port||(a.port=a.host.split(":")[1]),a.host=a.host.split(":")[0]),a.port||(a.port="https:"==a.protocol?443:80);var c=new e(new g,a);return b&&c.on("response",b),c},d.get=function(a,b){a.method="GET";var c=d.request(a,b);return c.end(),c},d.Agent=function(){},d.Agent.defaultMaxSockets=4;var g=function(){if("undefined"==typeof window)throw new Error("no window object present");if(window.XMLHttpRequest)return window.XMLHttpRequest;if(window.ActiveXObject){for(var a=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"],b=0;b<a.length;b++)try{var c=new window.ActiveXObject(a[b]);return function(){if(c){var d=c;return c=null,d}return new window.ActiveXObject(a[b])}}catch(d){}throw new Error("ajax not supported in this browser")}throw new Error("ajax not supported in this browser")}();d.STATUS_CODES={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{"./lib/request":53,events:29,url:49}],53:[function(a,b,c){var d=a("stream"),e=a("./response"),f=a("Base64"),g=a("inherits"),h=b.exports=function(a,b){var c=this;c.writable=!0,c.xhr=a,c.body=[],c.uri=(b.protocol||"http:")+"//"+b.host+(b.port?":"+b.port:"")+(b.path||"/"),"undefined"==typeof b.withCredentials&&(b.withCredentials=!0);try{a.withCredentials=b.withCredentials}catch(d){}if(b.responseType)try{a.responseType=b.responseType}catch(d){}if(a.open(b.method||"GET",c.uri,!0),a.onerror=function(a){c.emit("error",new Error("Network error"))},c._headers={},b.headers)for(var g=i(b.headers),h=0;h<g.length;h++){var j=g[h];if(c.isSafeRequestHeader(j)){var k=b.headers[j];c.setHeader(j,k)}}b.auth&&this.setHeader("Authorization","Basic "+f.btoa(b.auth));var l=new e;l.on("close",function(){c.emit("close")}),l.on("ready",function(){c.emit("response",l)}),l.on("error",function(a){c.emit("error",a)}),a.onreadystatechange=function(){a.__aborted||l.handle(a)}};g(h,d),h.prototype.setHeader=function(a,b){this._headers[a.toLowerCase()]=b},h.prototype.getHeader=function(a){return this._headers[a.toLowerCase()]},h.prototype.removeHeader=function(a){delete this._headers[a.toLowerCase()]},h.prototype.write=function(a){this.body.push(a)},h.prototype.destroy=function(a){this.xhr.__aborted=!0,this.xhr.abort(),this.emit("close")},h.prototype.end=function(a){void 0!==a&&this.body.push(a);for(var b=i(this._headers),c=0;c<b.length;c++){var d=b[c],e=this._headers[d];if(j(e))for(var f=0;f<e.length;f++)this.xhr.setRequestHeader(d,e[f]);else this.xhr.setRequestHeader(d,e)}if(0===this.body.length)this.xhr.send("");else if("string"==typeof this.body[0])this.xhr.send(this.body.join(""));else if(j(this.body[0])){for(var g=[],c=0;c<this.body.length;c++)g.push.apply(g,this.body[c]);this.xhr.send(g)}else if(/Array/.test(Object.prototype.toString.call(this.body[0]))){for(var h=0,c=0;c<this.body.length;c++)h+=this.body[c].length;for(var g=new this.body[0].constructor(h),k=0,c=0;c<this.body.length;c++)for(var m=this.body[c],f=0;f<m.length;f++)g[k++]=m[f];this.xhr.send(g)}else if(l(this.body[0]))this.xhr.send(this.body[0]);else{for(var g="",c=0;c<this.body.length;c++)g+=this.body[c].toString();this.xhr.send(g)}},h.unsafeHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"],
h.prototype.isSafeRequestHeader=function(a){return a?-1===k(h.unsafeHeaders,a.toLowerCase()):!1};var i=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b},j=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},k=function(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1},l=function(a){return"undefined"!=typeof Blob&&a instanceof Blob?!0:"undefined"!=typeof ArrayBuffer&&a instanceof ArrayBuffer?!0:"undefined"!=typeof FormData&&a instanceof FormData?!0:void 0}},{"./response":54,Base64:55,inherits:56,stream:47}],54:[function(a,b,c){function d(a){for(var b=a.getAllResponseHeaders().split(/\r?\n/),c={},d=0;d<b.length;d++){var e=b[d];if(""!==e){var f=e.match(/^([^:]+):\s*(.*)/);if(f){var g=f[1].toLowerCase(),h=f[2];void 0!==c[g]?i(c[g])?c[g].push(h):c[g]=[c[g],h]:c[g]=h}else c[e]=!0}}return c}var e=a("stream"),f=a("util"),g=b.exports=function(a){this.offset=0,this.readable=!0};f.inherits(g,e);var h={streaming:!0,status2:!0};g.prototype.getResponse=function(a){var b=String(a.responseType).toLowerCase();return"blob"===b?a.responseBlob||a.response:"arraybuffer"===b?a.response:a.responseText},g.prototype.getHeader=function(a){return this.headers[a.toLowerCase()]},g.prototype.handle=function(a){if(2===a.readyState&&h.status2){try{this.statusCode=a.status,this.headers=d(a)}catch(b){h.status2=!1}h.status2&&this.emit("ready")}else if(h.streaming&&3===a.readyState){try{this.statusCode||(this.statusCode=a.status,this.headers=d(a),this.emit("ready"))}catch(b){}try{this._emitData(a)}catch(b){h.streaming=!1}}else 4===a.readyState&&(this.statusCode||(this.statusCode=a.status,this.emit("ready")),this._emitData(a),a.error?this.emit("error",this.getResponse(a)):this.emit("end"),this.emit("close"))},g.prototype._emitData=function(a){var b=this.getResponse(a);return b.toString().match(/ArrayBuffer/)?(this.emit("data",new Uint8Array(b,this.offset)),void(this.offset=b.byteLength)):void(b.length>this.offset&&(this.emit("data",b.slice(this.offset)),this.offset=b.length))};var i=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}},{stream:47,util:51}],55:[function(a,b,c){!function(){function a(a){this.message=a}var b="undefined"!=typeof c?c:this,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.prototype=new Error,a.prototype.name="InvalidCharacterError",b.btoa||(b.btoa=function(b){for(var c,e,f=0,g=d,h="";b.charAt(0|f)||(g="=",f%1);h+=g.charAt(63&c>>8-f%1*8)){if(e=b.charCodeAt(f+=.75),e>255)throw new a("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");c=c<<8|e}return h}),b.atob||(b.atob=function(b){if(b=b.replace(/=+$/,""),b.length%4==1)throw new a("'atob' failed: The string to be decoded is not correctly encoded.");for(var c,e,f=0,g=0,h="";e=b.charAt(g++);~e&&(c=f%4?64*c+e:e,f++%4)?h+=String.fromCharCode(255&c>>(-2*f&6)):0)e=d.indexOf(e);return h})}()},{}],56:[function(a,b,c){b.exports=a(30)},{"/home/josh/src/imjs/node_modules/grunt-browserify/node_modules/browserify/node_modules/inherits/inherits_browser.js":30}],57:[function(a,b,c){function d(){k=!1,h.length?j=h.concat(j):l=-1,j.length&&e()}function e(){if(!k){var a=setTimeout(d);k=!0;for(var b=j.length;b;){for(h=j,j=[];++l<b;)h[l].run();l=-1,b=j.length}h=null,k=!1,clearTimeout(a)}}function f(a,b){this.fun=a,this.array=b}function g(){}var h,i=b.exports={},j=[],k=!1,l=-1;i.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];j.push(new f(a,b)),1!==j.length||k||setTimeout(e,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.binding=function(a){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(a){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}]},{},[2])(2)})}(window.intermine);